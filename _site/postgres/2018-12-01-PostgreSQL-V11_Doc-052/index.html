<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Глава 52. Системные каталоги &#8211; Sirius Blog</title>
<meta name="description" content="">
<meta name="keywords" content="PostgreSQL">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:4000/images/abstract-11.jpg">

<meta name="twitter:title" content="Глава 52. Системные каталоги">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@2hotab2">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Глава 52. Системные каталоги">
<meta property="og:description" content="">
<meta property="og:url" content="http://localhost:4000/postgres/2018-12-01-PostgreSQL-V11_Doc-052/">
<meta property="og:site_name" content="Sirius Blog">





<link rel="canonical" href="http://localhost:4000/postgres/2018-12-01-PostgreSQL-V11_Doc-052/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Sirius Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.jpg">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.jpg">
<!-- 114x72 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x72" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.jpg">
<!-- 144x72 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x72" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.jpg">



</head>

<body id="page" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://localhost:4000/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://localhost:4000/images/avatar.jpg" alt="Sergey Khatsiola photo" class="author-photo">
					<h4>Sergey Khatsiola</h4>
					<p>Кратко обо мне ...</p>
				</li>
				<li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:2hotab2@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/2hotab2"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="https://facebook.com/sergej.ha1"><i class="fa fa-fw fa-facebook"></i> Facebook</a>
				</li>
				
				
				<li>
					<a href="https://github.com/Sergey-sirius"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://localhost:4000/posts/">All Posts</a></li>
				<li><a href="http://localhost:4000/tags/">All Tags</a></li>
			</ul>
		</li>
		
	    
	    <li><a href="http://localhost:4000/handbook/" >HandBook</a></li>
	  
	    
	    <li><a href="http://localhost:4000/postgres/" >PostgreSQL_11</a></li>
	  
	    
	    <li><a href="http://mademistakes.com" target="_blank">Main Link</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
  
  <div class="entry-image">
    <img src="http://localhost:4000/images/abstract-11.jpg" alt="Глава 52. Системные каталоги">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        <h1 class="entry-title">Глава 52. Системные каталоги</h1>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
Reading time ~116 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>Глава 52. Системные каталоги</p>

<p>Системные каталоги — это место, где система управления реляционной базой данных хранит ме-
таданные схемы, в частности информацию о таблицах и столбцах, а также служебные сведения.
Системные каталоги PostgreSQL представляют собой обычные таблицы. Поэтому вы можете уда-
лить и пересоздать их, добавить столбцы, изменить и добавить строки, т. е. разными способами
вмешаться в работу системы. Обычно модифицировать системные каталоги вручную не следует,
для всего этого, как правило, есть команды SQL. (Например, CREATE DATABASE вставляет строку
в каталог pg_database — и фактически создаёт базу данных на диске.) Исключение составляют
только особенные эзотерические операции, но многие из них со временем становятся выполнимы-
ми посредством SQL-команд, так что потребность напрямую модифицировать системные каталоги
постоянно уменьшается.
52.1. Обзор
В Таблице 52.1 кратко перечислены системные каталоги. Более подробное описание каждого ка-
талога следует далее.
Большинство системных каталогов копируются из базы-шаблона при создании базы данных и за-
тем принадлежат этой базе. Но некоторые каталоги физически разделяются всеми базами данных
в кластере; это отмечено в их описаниях.
Таблица 52.1. Системные каталоги
Имя каталога Предназначение
pg_aggregate агрегатные функции
pg_am методы доступа индексов
pg_amop операторы методов доступа
pg_amproc опорные функции методов доступа
pg_attrdef значения столбцов по умолчанию
pg_attribute столбцы таблиц («атрибуты»)
pg_authid идентификаторы для авторизации (роли)
pg_auth_members отношения членства для объектов авторизации
pg_cast приведения (преобразования типов данных)
pg_class таблицы, индексы, последовательности, пред-
ставления («отношения»)
pg_collation правила сортировки (параметры локали)
pg_constraint ограничения-проверки, ограничения уникаль-
ности, ограничения первичного ключа и внеш-
них ключей
pg_conversion информация о перекодировках
pg_database базы данных в этом кластере
pg_db_role_setting параметры, задаваемые на уровне ролей и баз
данных
pg_default_acl права по умолчанию для различных типов объ-
ектов
pg_depend зависимости между объектами базы данных
pg_description описания или комментарии к объектам базы
данных
pg_enum определения меток и значений перечислений
1922Системные каталоги
Имя каталога Предназначение
pg_event_trigger событийные триггеры
pg_extension установленные расширения
pg_foreign_data_wrapper определения обёрток сторонних данных
pg_foreign_server определения сторонних серверов
pg_foreign_table дополнительные свойства сторонних таблиц
pg_index дополнительные свойства индексов
pg_inherits иерархия наследования таблиц
pg_init_privs начальные права для объектов
pg_language языки для написания функций
pg_largeobject страницы данных для больших объектов
pg_largeobject_metadata метаданные для больших объектов
pg_namespace схемы
pg_opclass классы операторов методов доступа
pg_operator операторы
pg_opfamily семейства операторов методов доступа
pg_partitioned_table информация о ключах разбиения таблиц
pg_pltemplate данные шаблонов для процедурных языков
pg_policy политики защиты строк
pg_proc функции и процедуры
pg_publication публикации для логической репликации
pg_publication_rel сопоставление отношений с публикациями
pg_range информация о типах диапазонов
pg_replication_origin зарегистрированные источники репликации
pg_rewrite правила перезаписи запросов
pg_seclabel метки безопасности для объектов базы данных
pg_sequence информация о последовательностях
pg_shdepend зависимости общих объектов
pg_shdescription комментарии к общим объектам
pg_shseclabel метки безопасности для общих объектов баз дан-
ных
pg_statistic статистика планировщика
pg_statistic_ext расширенная статистика планировщика
pg_subscription подписки логической репликации
pg_subscription_rel состояние отношений для подписок
pg_tablespace табличные пространства в этом кластере баз
данных
pg_transform трансформации (тип данных для преобразова-
ний процедурных языков)
pg_trigger триггеры
pg_ts_config конфигурации текстового поиска
1923Системные каталоги
Имя каталога Предназначение
pg_ts_config_map сопоставления фрагментов в конфигурациях
текстового поиска
pg_ts_dict словари текстового поиска
pg_ts_parser анализаторы текстового поиска
pg_ts_template шаблоны текстового поиска
pg_type типы данных
pg_user_mapping сопоставления пользователей для сторонних
серверов
52.2. pg_aggregate
В каталоге pg_aggregate хранится информация об агрегатных функциях. Агрегатная функция —
это такая функция, которая работает с множеством значений (обычно, с содержимым одного
столбца всех строк, удовлетворяющих условию запроса) и возвращает одно значение, вычисленное
по этому множеству. Типичные агрегатные функции — sum, count и max. Все записи в pg_aggregate
представляют собой дополнение записей в pg_proc. Запись в pg_proc определяет имя агрегатной
функции, типы входных и выходных данных, а также другие свойства, подобные имеющимся у
обычных функций.
Таблица 52.2. Столбцы pg_aggregate
Имя Тип Ссылки Описание
aggfnoid regproc pg_proc .oid OID агрегатной функ-
ции в pg_proc
aggkind char Тип агрегатной функ-
ции: n — обычная (
«normal»), o — сорти-
рующая («ordered-set»)
или h — гипотезирую-
щая («hypothetical-set»)
aggnumdirectargs int2 Число непосредствен-
ных (не агрегируемых)
аргументов для сорти-
рующей или гипоте-
зирующей агрегатной
функции (переменный
массив аргументов счи-
тается одним аргумен-
том). Если равняет-
ся pronargs, агрегат-
ная функция должна
принимать переменный
массив и этот мас-
сив описывает как агре-
гатные аргументы, так
и окончательные непо-
средственные аргумен-
ты. Всегда равно нулю
для обычных агрегат-
ных функций.
aggtransfn regproc pg_proc .oid Функция перехода
aggfinalfn regproc pg_proc .oid Функция завершения (
0, если её нет)
1924Системные каталоги
Имя Тип Ссылки Описание
aggcombinefn regproc pg_proc .oid Комбинирующая функ-
ция (0, если её нет)
aggserialfn regproc pg_proc .oid Функция сериализации
(0, если её нет)
aggdeserialfn regproc pg_proc .oid Функция десериализа-
ции (0, если её нет)
aggmtransfn regproc pg_proc .oid Функция прямого пере-
хода для режима дви-
жущегося агрегата (0,
если её нет)
aggminvtransfn regproc pg_proc .oid Функция обратного пе-
рехода для режима дви-
жущегося агрегата (0,
если её нет)
aggmfinalfn regproc pg_proc .oid Функция
завершения
для режима движуще-
гося агрегата (0, если
её нет)
aggfinalextra bool Со значением True в
aggfinalfn передаются
дополнительные фик-
тивные аргументы
aggmfinalextra bool Со
значением
True
в aggmfinalfn переда-
ются дополнительные
фиктивные аргументы
aggfinalmodify char Признак
модифици-
рования
переходного
состояния
функцией
aggfinalfn: r, если со-
стояние только чита-
ется; s, если функ-
цию aggtransfn нель-
зя применять после
aggfinalfn; и w, если
состояние перезаписы-
вается
aggmfinalmodify char Аналогично
aggfinalmodify, но для
aggmfinalfn
aggsortop oid pg_operator .oid Связанный
оператор
сортировки (0, если его
нет)
aggtranstype oid pg_type .oid Тип данных внутренне-
го состояния (перехо-
да) агрегатной функции
aggtransspace int4
Приблизительный
средний размер (в бай-
тах) данных состояния
перехода, либо 0 для
1925Системные каталоги
Имя Тип Ссылки Описание
выбора значения
умолчанию
aggmtranstype oid pg_type .oid Тип данных внутрен-
него состояния (пере-
хода) для агрегатной
функции в режиме дви-
жущегося агрегата (0 в
случае отсутствия)
aggmtransspace int4 Приблизительный
средний размер (в бай-
тах) данных состояния
перехода для режима
движущегося агрегата,
либо 0 для выбора зна-
чения по умолчанию
agginitval text Начальное
значение
для состояния перехо-
да. Это текстовое поле,
содержащее значение в
виде внешнего строко-
вого представления. Ес-
ли это поле содержит
NULL, начальным зна-
чением состояния пе-
рехода будет NULL.
aggminitval text Начальное
значение
для состояния перехода
в режиме движущего-
ся агрегата. Это тексто-
вое поле, содержащее
значение в виде внеш-
него строкового пред-
ставления. Если это по-
ле содержит NULL, на-
чальным значением со-
стояния перехода будет
NULL.
по
Новые агрегатные функции создаются командой CREATE AGGREGATE. За дополнительными све-
дениями о разработке агрегатных функций, значении функций перехода и т. д. обратитесь к Раз-
делу 38.11.
52.3. pg_am
В каталоге pg_am хранится информация о методах доступа отношений. Каждая строка в нём опи-
сывает один метода доступа, поддерживаемый системой. В настоящее время методы доступа за-
даются только для индексов. Требования для реализации методов доступа индексов подробно рас-
сматриваются в Главе 61.
Таблица 52.3. Столбцы pg_am
Имя Тип
oid oid
Ссылки
Описание
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
1926Системные каталоги
Имя Тип
amname name
amhandler regproc
amtype char
Ссылки
Описание
Имя метода доступа
pg_proc .oid
OID функции-обработ-
чика,
предоставляю-
щей информацию о ме-
тоде доступа
На данный момент это
всегда i, что указывает,
что это метод доступа
индекса; в будущем мо-
гут появиться и другие
значения
Примечание
До PostgreSQL 9.6, в pg_am было много дополнительных столбцов, представляющих
свойства методов доступа индексов. Теперь эти данные непосредственно видны только
на уровне кода C. Однако, чтобы SQL-запросы всё же могли проверять свойства мето-
дов доступа индексов, была введена функция pg_index_column_has_property() и ряд
связанных функций; см. Таблицу 9.63.
52.4. pg_amop
В каталоге pg_amop хранится информация об операторах, связанных с семействами операторов ме-
тодов доступа. Каждая строка в нём описывает оператор, являющийся членом семейства операто-
ров. Членом семейства может быть либо оператор поиска, либо оператор упорядочивания. Опера-
тор может относиться к нескольким семействам, но он не может находиться в одном семействе в
более чем одной позиции поиска или позиции упорядочивания. (Допустимо, хотя и маловероятно,
что оператор будет использоваться и для поиска, и для упорядочивания.)
Таблица 52.4. Столбцы pg_amop
Имя Тип
Ссылки
Описание
oid oid amopfamily oid pg_opfamily .oid Семейство операторов,
к которому относится
эта запись
amoplefttype oid pg_type .oid Тип данных левого опе-
ранда оператора
amoprighttype oid pg_type .oid Тип данных правого
операнда оператора
amopstrategy int2 Номер стратегии опе-
ратора
amoppurpose char Предназначение опера-
тора: s — поиск (
search), o — упорядочи-
вание (ordering)
amopopr oid pg_operator .oid OID оператора
amopmethod oid pg_am .oid Метод доступа индекса,
для которого предна-
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
1927Системные каталоги
Имя Тип Ссылки Описание
значено семейство опе-
раторов
amopsortfamily oid pg_opfamily .oid Семейство операторов
B-дерева, в соответ-
ствии с которым сор-
тирует данный опера-
тор, если это оператор
упорядочивания; 0, ес-
ли это оператор поиска
Запись оператора «поиска» указывает, что по индексу этого семейства операторов можно произ-
водить поиск и найти все строки, удовлетворяющие условию WHERE столбец_индекса оператор кон-
станта. Очевидно, такой оператор должен возвращать тип boolean, а тип его левого операнда дол-
жен соответствовать типу данных столбца индекса.
Запись оператора «упорядочивания» указывает, что по индексу этого семейства операторов мож-
но провести сканирование и получить строки в порядке, заданном предложением ORDER BY стол-
бец_индекса оператор константа. Такой оператор может возвращать любой сортируемый тип дан-
ных, хотя тип левого операнда должен так же соответствовать типу данных столбца индекса. Точ-
ная семантика ORDER BY определяется столбцом amopsortfamily, который должна указывать на
семейство операторов B-дерева для типа, возвращаемого оператором.
Примечание
В настоящее время предполагается, что порядком сортировки для упорядочивающего
оператора будет порядок по умолчанию для соответствующего семейства операторов,
то есть, ASC NULLS LAST. Когда-нибудь для большей гибкости могут быть добавлены
дополнительные столбцы, позволяющие явно задавать параметры сортировки.
Поле amopmethod в записи оператора должно соответствовать полю opfmethod содержащего его
семейства (amopmethod добавлен сюда намеренно, эта денормализация структуры каталога объяс-
няется соображениями производительности). Также, поля amoplefttype и amoprighttype должны
соответствовать полям oprleft и oprright в записи pg_operator, на которую ссылается данная.
52.5. pg_amproc
В каталоге pg_amproc хранится информация об опорных функциях, связанных с семействами опе-
раторов методов доступа. Строки в нём описывают все опорные функции, принадлежащие семей-
ству операторов.
Таблица 52.5. Столбцы pg_amproc
Имя Тип
Ссылки
Описание
oid oid amprocfamily oid pg_opfamily .oid Семейство операторов,
к которому относится
эта запись
amproclefttype oid pg_type .oid Тип данных левого опе-
ранда связанного опе-
ратора
amprocrighttype oid pg_type .oid Тип
данных
право-
го операнда связанного
оператора
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
1928Системные каталоги
Имя Тип
amprocnum int2
amproc regproc
Ссылки
Описание
Номер опорной функ-
ции
pg_proc .oid
OID функции
Обычно принято, что amproclefttype и amprocrighttype определяют типы левого и правого опе-
ранда оператора, который поддерживает конкретная опорная функция. Для некоторых методов до-
ступа они соответствуют типам входных данных самой опорной функции, для других — нет. Есть по-
нятие «стандартных» опорных функций для индекса; это такие функции, у которых amproclefttype
и amprocrighttype равняются opcintype класса оператора индекса.
52.6. pg_attrdef
В каталоге pg_attrdef хранятся значения столбцов по умолчанию. Основная информация о столб-
цах хранится в pg_attribute (см. ниже). В этой таблице записи будут только для тех столбцов, для
которых явно задаётся значение по умолчанию (при создании таблицы или добавлении столбца).
Таблица 52.6. Столбцы pg_attrdef
Имя Тип
Ссылки
Описание
oid oid adrelid oid pg_class .oid Таблица, к которой при-
надлежит столбец
adnum int2 pg_attribute .attnum Номер столбца
adbin pg_node_tree Внутреннее представ-
ление значения столб-
ца по умолчанию
adsrc text Понятное
человеку
представление значе-
ния по умолчанию
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
Поле adsrc присутствует по исторически причинам, его не стоит использовать, так как в нём не
отражаются внешние факторы, способные повлиять на представление значения по умолчанию.
Для отображения значения по умолчанию лучше декомпилировать поле adbin (применив, напри-
мер pg_get_expr ).
52.7. pg_attribute
В каталоге pg_attribute хранится информация о столбцах таблицы. Для каждого столбца каждой
таблицы в pg_attribute существует ровно одна строка. (Также в этом каталоге будут записи для
индексов и на самом деле для всех объектов, присутствующих в pg_class.)
Термин «атрибут» равнозначен «столбцу» и употребляется по историческим причинам.
Таблица 52.7. Столбцы pg_attribute
Имя Тип Ссылки Описание
attrelid oid pg_class .oid Таблица, к которой при-
надлежит столбец
attname name atttypid oid attstattarget int4
Имя столбца
pg_type .oid
Тип
данных
столбца
этого
Столбец attstattarget
управляет детализаци-
1929Системные каталоги
Имя Тип
Ссылки
attlen int2 Копия pg_type.typlen
из записи типа столбца
attnum int2 Порядковый
номер
столбца.
Обычные
столбцы нумеруются по
возрастанию, начиная с</p>
<ol>
  <li>Системные столбцы,
такие как oid, имеют (
обычно) отрицательные
номера.
attndims int4 Число
размерностей,
если столбец имеет тип
массива; 0 в противном
случае. (В настоящее
время число размерно-
стей массива не контро-
лируется, поэтому лю-
бое ненулевое значе-
ние по сути означает
«это массив».)
attcacheoff int4 Всегда -1 в постоянном
хранилище, но когда за-
пись загружается в па-
мять, в этом поле мо-
жет кешироваться сме-
щение атрибута в стро-
ке
atttypmod int4 В поле atttypmod запи-
сывается дополнитель-
ное число, связанное
с определённым типом
данных,
указываемое
при создании табли-
1930
Описание
ей статистики, собира-
емой по этому столб-
цу командой ANALYZE.
Нулевое значение ука-
зывает, что статисти-
ка не собирается. При
отрицательном значе-
нии используется си-
стемное ограничение
статистики по умол-
чанию. Точное значе-
ние положительных ве-
личин определяется ти-
пом данных. Для ска-
лярных типов данных,
attstattarget задаёт и
целевое число собирае-
мых «самых частых зна-
чений», и целевое чис-
ло создаваемых групп
гистограммы.Системные каталоги
Имя Тип
Ссылки
attbyval bool Копия
pg_
type.typbyval из за-
писи типа столбца
attstorage char Обычно
копия
pg_
type.typstorage
из
записи типа столбца.
Для типов, поддержи-
вающих TOAST, можно
изменять это значение
после создания столбца
и таким образом управ-
лять политикой хране-
ния.
attalign char Копия
pg_
type.typalign из за-
писи типа столбца
attnotnull bool Представляет ограни-
чение NOT NULL.
atthasdef bool Столбец имеет значе-
ние по умолчанию, в
этом случае в каталоге
pg_attrdef будет со-
ответствующая запись,
определяющая это зна-
чение.
atthasmissing bool Столбец имеет значе-
ние, которое исполь-
зуется, когда он пол-
ностью отсутствует в
строке. Это имеет ме-
сто,
когда
столбец
добавляется с неиз-
менчивым значением
DEFAULT после созда-
ния строки. Фактиче-
ское значение хранит-
ся в attmissingval.
attidentity char Если нулевой байт (‘’),
это не столбец иденти-
фикации. В противном
случае, при a значе-
ние генерируется все-
гда, при d — значение
1931
Описание
цы (например, макси-
мальный размер столб-
ца varchar). Это зна-
чение передаётся функ-
циям ввода и преоб-
разования длины кон-
кретного типа. Для ти-
пов, которым не нужен
atttypmod, это обычно
-1.Системные каталоги
Имя Тип
Ссылки
attisdropped bool Столбец была удалён
и теперь не являет-
ся рабочим. Удалён-
ный столбец может по-
прежнему физически
присутствовать в табли-
це, но анализатор за-
просов его игнорирует,
так что обратиться к
нему из SQL нельзя.
attislocal bool Столбец определён ло-
кально в данном отно-
шении. Заметьте, что
столбец может быть
определён локально и
при этом наследовать-
ся.
attinhcount int4 Число прямых предков
этого столбца. Столбец
с ненулевым числом
предков нельзя удалить
или переименовать.
attcollation oid attacl aclitem[] Права доступа к столб-
цу, если они были за-
даны непосредственно
для этого столбца
attoptions text[] Параметры уровня ат-
рибута, в виде строк
«ключ=значение»
attfdwoptions text[] Параметры уровня ат-
рибута для обёрток сто-
ронних данных, в ви-
де строк «ключ=значе-
ние»
attmissingval anyarray В данном столбце раз-
мещается массив с од-
ним элементом. Зна-
чение в этом элемен-
те используется, ко-
гда столбец полностью
отсутствует
в
стро-
ке, что имеет место,
когда столбец добав-
ляется с неизменчи-
вым значением DEFAULT
после создания стро-
ки. Это значение ис-
pg_collation .oid
1932
Описание
генерируется по умол-
чанию.
Заданное для столб-
ца правило сортировки,
либо 0, если тип столб-
ца не сортируемый.Системные каталоги
Имя
Тип
Ссылки
Описание
пользуется, только ко-
гда atthasmissing ра-
вен true. Если значе-
ние отсутствует, стол-
бец будет содержать
NULL.
В записи удалённого столбца в pg_attribute поле atttypid сбрасывается в ноль, но attlen и дру-
гие поля, копируемые из pg_type, сохраняют актуальные значения. Это нужно, чтобы справиться
с ситуацией, когда после удаления столбца удаляется и его тип данных, так что записи в pg_type
больше не будет. В таких случаях для интерпретации содержимого строки таблицы могут исполь-
зоваться attlen и другие поля.
52.8. pg_authid
В каталоге pg_authid содержится информация об идентификаторах для авторизации (ролях). Роль
включает в себя концепции «пользователей» и «групп». Пользователь по существу представляет
собой частный случай роли, с флагом rolcanlogin. Любая роль (с или без флага rolcanlogin)
может включать другие роли в качестве членов; см. pg_auth_members.
Так как в этом каталоге содержатся пароли, он не должен быть открыт для всех. Для общего поль-
зования предназначено представление pg_roles на базе pg_authid, в котором поле пароля очи-
щено.
За подробной информацией о пользователях и управлении правами обратитесь к Главе 21.
Так как пользователи определяются глобально, каталог pg_authid разделяется всеми базами дан-
ных кластера; есть только единственная копия pg_authid в кластере, а не отдельные в каждой
базе данных.
Таблица 52.8. Столбцы pg_authid
Имя Тип Описание
oid oid Идентификатор строки (скры-
тый атрибут; должен выбирать-
ся явно)
rolname name Имя роли
rolsuper bool Роли имеет права суперпользо-
вателя
rolinherit bool Роль автоматически наследует
права ролей, в которые она
включена
rolcreaterole bool Роль может создавать другие
роли
rolcreatedb bool Роль может создавать базы дан-
ных
rolcanlogin bool Роль может подключаться к
серверу. То есть эта роль может
быть указана в качестве началь-
ного идентификатора авториза-
ции сеанса
rolreplication bool Роль является ролью реплика-
ции. Такие роли могут устанав-
ливать соединения для репли-
1933Системные каталоги
Имя Тип Описание
кации и создавать/удалять сло-
ты репликации.
rolbypassrls bool Роль не подчиняется никаким
политикам защиты на уровне
строк; за подробностями обра-
титесь к Разделу 5.7.
rolconnlimit int4 Для ролей, которые могут под-
ключаться к серверу, это зна-
чение задаёт максимально раз-
решённое для этой роли чис-
ло одновременных подключе-
ний. При значении -1 ограниче-
ния нет.
rolpassword text Пароль (возможно зашифрован-
ный); NULL, если он не задан.
Его формат зависит от исполь-
зуемого вида шифрования.
rolvaliduntil timestamptz Срок действия пароля (исполь-
зуется только при аутентифи-
кации по паролю); NULL, если
срок действия не ограничен
Если пароль зашифрован MD5, значение в rolpassword начинается со строки md5, за которой идёт
32-символьный шестнадцатеричный хеш MD5. Этот хеш вычисляется для пароля пользователя с
добавленным за ним его именем. Например, если у пользователя joe пароль xyzzy, PostgreSQL
сохранит в этом поле md5-хеш строки xyzzyjoe.
Если пароль зашифрован по алгоритму SCRAM-SHA-256, он имеет формат:
SCRAM-SHA-256$<число итераций="">:<соль>$<СохранённыйКлюч>:<КлючСервера>
Здесь соль, СохранённыйКлюч и КлючСервера кодируются в формате Base64. Этот формат соответ-
ствует стандарту RFC 5803.
Пароль, не удовлетворяющий ни одному из этих форматов, считается незашифрованным.
52.9. pg_auth_members
Каталог pg_auth_members представляет отношения членства между ролями. Допускается любая
не зацикленная иерархия отношений.
Так как пользователи определяются глобально, pg_auth_members разделяется всеми базами дан-
ных кластера; есть только единственная копия pg_auth_members в кластере, а не отдельные в каж-
дой базе данных.
Таблица 52.9. Столбцы pg_auth_members
Имя Тип Ссылки Описание
roleid oid pg_authid .oid Идентификатор роли,
включающей другую
member oid pg_authid .oid Идентификатор
включаемой
в
roleid
grantor oid pg_authid .oid Идентификатор роли,
разрешившей членство
admin_option bool
роли,
роль
True, если member мо-
жет разрешать член-
1934Системные каталоги
Имя
Тип
Ссылки
Описание
ство в roleid другим
ролям
52.10. pg_cast
В каталоге pg_cast хранятся пути приведения типов (как встроенных, так и пользовательских).
Следует заметить, что pg_cast представляет не каждое приведение, которое может выполнять си-
стема, а только те, которые нельзя вывести по некоторым общим правилам. Например, приведение
типа домена к его базовому типу не представляется явно в pg_cast. Ещё одно важное исключе-
ние составляют «автоматические приведения ввода/вывода», которые выполняются с применени-
ем собственных функций ввода/вывода типа данных, преобразующих тип в text или другие стро-
ковые типы — они также не представляются явно в pg_cast.
Таблица 52.10. Столбцы pg_cast
Имя Тип
Ссылки
Описание
oid oid castsource oid pg_type .oid OID исходного
данных
casttarget oid pg_type .oid OID целевого типа дан-
ных
castfunc oid pg_proc .oid OID функции, выполня-
ющей приведение, или
0, если для данного
метода приведения не
требуется функция.
castcontext char Определяет, в каких
контекстах может вы-
полняться приведение.
Символ
e
означает
только явное приведе-
ние (explicit), с при-
менением синтаксиса
CAST или ::. Символ a
означает неявное при-
сваивание (assignment)
целевому столбцу, а
также явное приведе-
ние. Символ i разреша-
ет неявное приведение
(implicit), а также все
остальные варианты.
castmethod char Показывает, как вы-
полняется приведение.
Символ f означает,
что используется функ-
ция, указанная в по-
ле castfunc. Символ i
означает, что использу-
ются функции ввода/вы-
вода. Символ b означа-
ют, что типы являют-
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
1935
типаСистемные каталоги
Имя
Тип
Ссылки
Описание
ся двоично-сводимыми,
так что преобразование
не требуется.
Функции приведения, перечисленные в pg_cast, должны всегда принимать исходный тип приве-
дения в качестве типа первого аргумента и возвращать результат, имеющий целевой тип. Функ-
ция приведения может иметь до трёх аргументов. Второй аргумент, если он присутствует, должен
иметь тип integer; в нём передаётся модификатор типа, связанный с целевым типом, либо -1, если
такого модификатора нет. Третий аргумент, если он присутствует, должен иметь тип boolean; в
нём передаётся true, если приведение выполняется явно, и false в противном случае.
Вполне возможно создать запись в pg_cast, в которой исходный тип будет совпадать с целевым,
если связанная функция приведения принимает больше одного аргумента. Такие записи представ-
ляют «функции преобразования длины», которые приводят значения некоторого типа в соответ-
ствие с заданным значением модификатора.
Когда в записи pg_cast исходный и целевой типы приведения различаются и функция принима-
ет более одного аргумента, эта запись представляет преобразование типа из одного в другой и
сведение к нужной длине за один шаг. Если же такой записи не находится, приведение к типу
с определённым модификатором выполняется в два этапа, сначала выполняется преобразование
типа, а затем применяется модификатор типа.
52.11. pg_class
В каталоге pg_class описываются таблицы и практически всё, что имеет столбцы или каким-то
образом подобно таблице. Сюда входят индексы (но смотрите также pg_index), последовательно-
сти (но смотрите также pg_sequence), представления, материализованные представления, состав-
ные типы и таблицы TOAST; см. relkind. Далее, подразумевая все эти типы объектов, мы будем
говорить об «отношениях». Не все столбцы здесь имеют смысл для всех типов отношений.
Таблица 52.11. Столбцы pg_class
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
relname name Имя таблицы, индекса,
представления и т. п.
relnamespace oid pg_namespace .oid OID
пространства
имён, содержащего это
отношение
reltype oid pg_type .oid OID типа данных, со-
ответствующего
типу
строки этой таблицы,
если таковой есть (ноль
для индексов, так как
они не имеют записи в
pg_type )
reloftype oid pg_type .oid Для
типизированных
таблиц, OID нижележа-
щего составного типа,
или ноль для всех дру-
гих отношений
relowner oid pg_authid .oid Владелец отношения
1936
ОписаниеСистемные каталоги
Имя Тип Ссылки Описание
relam oid pg_am .oid Если это индекс, при-
меняемый метод досту-
па (B-дерево, хеш и т.
д.)
relfilenode oid reltablespace oid relpages int4 Размер представления
этой таблицы на дис-
ке (в страницах разме-
ра BLCKSZ). Это лишь
примерная оценка, ис-
пользуемая планиров-
щиком. Она обновляет-
ся командами VACUUM,
ANALYZE и несколькими
командами DDL, напри-
мер, CREATE INDEX.
reltuples float4 Число
актуальных
строк в таблице. Это
лишь примерная оцен-
ка, используемая пла-
нировщиком. Она об-
новляется командами
VACUUM,
ANALYZE
и
несколькими команда-
ми
DDL,
например,
CREATE INDEX.
relallvisible int4 Число страниц, поме-
ченных как «полно-
стью видимые» в кар-
те видимости табли-
цы. Это лишь при-
мерная
оценка,
ис-
пользуемая планиров-
щиком. Она обновляет-
ся командами VACUUM,
ANALYZE и несколькими
командами DDL, напри-
мер, CREATE INDEX.
Имя файла на диске с
этим отношением; ноль
означает, что это «отоб-
ражённое» представле-
ние, имя файла для
которого определяется
состоянием на нижнем
уровне
pg_tablespace .oid
1937
Табличное
простран-
ство, в котором хранит-
ся это отношение. Если
ноль, подразумевается
пространство базы дан-
ных по умолчанию. (Не
имеет значения, если с
отношением не связан
файл на диске.)Системные каталоги
Имя Тип Ссылки Описание
reltoastrelid oid pg_class .oid OID таблицы TOAST,
связанной с данной таб-
лицей, или 0, если та-
ковой нет. В таблицу
TOAST, как во вторич-
ную, «выносятся» боль-
шие атрибуты.
relhasindex bool True, если это таблица
и она имеет (или недав-
но имела) индексы
relisshared bool True, если эта таблица
разделяется всеми ба-
зами данных в класте-
ре. Разделяемыми яв-
ляются только некото-
рые системные катало-
ги (как например, pg_
database ).
relpersistence char p = постоянная таб-
лица (permanent), u =
нежурналируемая таб-
лица (unlogged), t =
временная таблица (
temporary)
relkind char r = обычная таблица (
Relation), i = индекс (
Index), S = последова-
тельность (Sequence),
t = таблица TOAST,
v = представление (
View), m = материализо-
ванное представление
(Materialized view), c
= составной тип (
Composite type), f =
сторонняя таблица (
Foreign table), p = сек-
ционированная табли-
ца (Partitioned table),
I = секционирован-
ный индекс (partitioned
Index)
relnatts int2 Число
пользователь-
ских столбцов в от-
ношении
(системные
столбцы не считают-
ся). Столько же со-
ответствующих
строк
должно быть в pg_
attribute . См. также
pg_attribute.attnum .
1938Системные каталоги
Имя Тип
Ссылки
relchecks int2 Число
ограничений
CHECK в таблице; см. ка-
талог pg_constraint
relhasoids bool True, если для каждой
строки отношения ге-
нерируется OID
relhasrules bool True, если для табли-
цы определены (или бы-
ли определены) прави-
ла; см. каталог pg_
rewrite
relhastriggers bool True, если для табли-
цы определены (или бы-
ли определены) триг-
геры; см. каталог pg_
trigger
relhassubclass bool True, если у таблицы
есть (или были) потом-
ки в иерархии наследо-
вания
relrowsecurity bool True, если для табли-
цы включена защита на
уровне строк; см. ката-
лог pg_policy
relforcerowsecurity bool True, если защита на
уровне строк (когда она
включена) также при-
меняется к владельцу
таблицы; см. каталог
pg_policy
relispopulated bool True, если отношение
наполнено данными (
это истинно для всех от-
ношений, кроме неко-
торых материализован-
ных представлений)
relreplident char Столбцы,
формирую-
щие
«идентификатор
реплики» для строк:
d = по умолчанию (
первичный ключ, ес-
ли есть), n = ника-
кие (nothing), f = все
столбцы, i = индекс (
index), если задано зна-
чение indisreplident,
либо набор по умолча-
нию
relispartition bool True, если таблица или
индекс является секци-
ей
1939
ОписаниеСистемные каталоги
Имя Тип Ссылки Описание
relrewrite oid pg_class .oid Для новых отношений,
записываемых в про-
цессе операции DDL,
требующей перезаписи
таблицы, это поле со-
держит OID исходного
отношения; в против-
ном случае — 0. Это
состояние видимо толь-
ко внутри; в этом по-
ле никогда не должно
быть ненулевого значе-
ния для видимого поль-
зователем отношения.
relfrozenxid xid Идентификаторы тран-
закций,
предшеству-
ющие
данному,
в
этой таблице замене-
ны постоянным («за-
мороженным») иденти-
фикатором транзакции.
Это нужно для опре-
деления, когда требу-
ется очищать табли-
цу для предотвращения
зацикливания иденти-
фикаторов или для со-
кращения объёма pg_
xact . Если это отно-
шение — не таблица,
значение равно нулю (
InvalidTransactionId).
relminmxid xid Идентификаторы муль-
титранзакций, предше-
ствующие данному, в
этой таблице замене-
ны другим идентифика-
тором транзакции. Это
нужно для определе-
ния, когда требуется
очищать таблицу для
предотвращения зацик-
ливания идентификато-
ров мультитранзакций
или для сокращения
объёма pg_multixact .
Если это отношение
— не таблица, зна-
чение равно нулю (
InvalidMultiXactId).
relacl aclitem[] Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
1940Системные каталоги
Имя Тип
Ссылки
Описание
reloptions text[] Специальные парамет-
ры для методов досту-
па, в виде строк «клю-
ч=значение»
relpartbound pg_node_tree Если таблица явля-
ется
секцией
(см.
relispartition), внут-
реннее представление
границ секции
Некоторые логические флаги в pg_class поддерживаются не строго: гарантируется, что они будут
установлены при переходе в определённое состояние, но они могут не сбрасываться немедленно,
когда условия поменяются. Например, relhasindex устанавливается командой CREATE INDEX, но
никогда не сбрасывается командой DROP INDEX. Вместо этого, флаг relhasindex сбрасывается ко-
мандой VACUUM, если она находит, что в таблице нет индексов. Такая организация позволяет избе-
жать состояния гонки и способствует параллельному использованию.
52.12. pg_collation
В каталоге pg_collation описываются доступные правила сортировки, которые по сути представ-
ляют собой сопоставления идентификаторов SQL с категориями локалей операционной системы.
За дополнительными сведениями обратитесь к Разделу 23.2.
Таблица 52.12. Столбцы pg_collation
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
collname name Имя правила сортиров-
ки (уникальное для про-
странства имён и коди-
ровки)
collnamespace oid pg_namespace .oid OID
пространства
имён, содержащего это
правило сортировки
collowner oid pg_authid .oid Владелец правила сор-
тировки
collprovider char Провайдер
правила
сортировки: d = уста-
новленный в базе по
умолчанию, c = libc, i =
icu
collencoding int4 Кодировка, для которой
применимо это прави-
ло, или -1, если оно ра-
ботает с любой коди-
ровкой
collcollate name LC_COLLATE для данно-
го объекта
collctype name LC_CTYPE
объекта
collversion text Определяемая провай-
дером версия прави-
1941
Описание
для данногоСистемные каталоги
Имя
Тип
Ссылки
Описание
ла сортировки. Она
записывается при со-
здании правила сор-
тировки и проверяет-
ся при использовании
для обнаружения изме-
нений в его определе-
нии, чреватых повре-
ждением данных.
Заметьте, что уникальный ключ в этом каталоге определён как (collname, collencoding,
collnamespace), а не просто как (collname, collnamespace). Вообще PostgreSQL игнорирует все
правила сортировки, для которых collencoding не равняется кодировке текущей базы данных или
-1, а создание новых записей с тем же именем, которое уже имеет запись с collencoding = -1,
запрещено. Таким образом, достаточно использовать полное имя SQL (схема.имя) для указания
правила сортировки, несмотря на то, что оно может быть неуникальным согласно определению
каталога. Такая организация каталога объясняется тем, что программа initdb наполняет его в мо-
мент инициализации кластера записями для всех локалей, обнаруженных в системе, так что она
должна иметь возможность сохранить записи для всех кодировок, которые могут вообще когда-ли-
бо применяться в кластере.
В базе данных template0 может быть полезно создать правила сортировки, кодировки которых
не соответствуют кодировке этой базы, но которые могут оказаться у баз данных, скопированных
впоследствии из template0. В настоящее время это придётся проделать вручную.
52.13. pg_constraint
В каталоге pg_constraint хранятся ограничения-проверки, ограничения-исключения, а также
ограничения первичного ключа, уникальности и внешних ключей, определённые для таблиц.
(Ограничения столбцов описываются как и все остальные. Любое ограничение столбца равнознач-
но некоторому ограничению таблицы.) Ограничения на NULL представляются не здесь, а в ката-
логе pg_attribute.
Для пользовательских триггеров ограничений (создаваемых командой CREATE
TRIGGER) в этой таблице также создаётся запись.
CONSTRAINT
Здесь также хранятся ограничения доменов.
Таблица 52.13. Столбцы pg_constraint
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
conname name Имя ограничения (не
обязательно уникаль-
ное!)
connamespace oid contype char
pg_namespace .oid
Описание
OID
пространства
имён, содержащего это
ограничение
c = ограничение-про-
верка (check), f = внеш-
ний ключ (foreign key),
p = первичный ключ (
primary key), u = огра-
ничение уникальности
(unique), t = триггер
1942Системные каталоги
Имя Тип
Ссылки
condeferrable bool Является ли ограниче-
ние откладываемым?
condeferred bool Является ли ограни-
чение отложенным по
умолчанию?
convalidated bool Было ли ограничение
проверено? В настоя-
щее время значение
false возможно только
для внешних ключей и
ограничений CHECK
conrelid oid pg_class .oid Таблица, для которой
установлено это огра-
ничение; 0, если это не
ограничение таблицы
contypid oid pg_type .oid Домен, к которому от-
носится это ограниче-
ние; 0, если это не огра-
ничение домена
conindid oid pg_class .oid Индекс, поддерживаю-
щий это ограничение,
если это ограничение
уникальности, первич-
ного
или
внешнего
ключа, либо ограниче-
ние-исключение; в про-
тивном случае — 0
conparentid oid pg_constraint .oid Соответствующее огра-
ничение в родитель-
ской
секционирован-
ной таблице, если это
ограничение в секции;
иначе 0
confrelid oid pg_class .oid Если
это
внешний
ключ, таблица, на кото-
рую он ссылается; ина-
че 0
confupdtype char Код действия при изме-
нении внешнего ключа:
a = нет действия, r =
ограничить (restrict), c
= каскадное действие (
cascade), n = присвоить
NULL, d = поведение по
умолчанию
confdeltype char Код действия при уда-
лении внешнего ключа:
a = нет действия, r =
ограничить (restrict), c
1943
Описание
ограничения (trigger), x
= ограничение-исклю-
чение (exclusion)Системные каталоги
Имя Тип
Ссылки
confmatchtype char Тип
сопоставления
внешнего ключа: f =
полное (full), p = ча-
стичное (partial), s =
простое (simple)
conislocal bool Ограничение определе-
но локально в данном
отношении. Заметьте,
что ограничение мо-
жет быть определено
локально и при этом на-
следоваться.
coninhcount int4 Число прямых пред-
ков этого ограничения.
Ограничение с нену-
левым числом предков
нельзя удалить или пе-
реименовать.
connoinherit bool Ограничение определе-
но локально для данно-
го отношения и являет-
ся ненаследуемым.
conkey int2[] pg_attribute .attnum Для ограничений таб-
лицы (включая внеш-
ние ключи, но не
триггеры
ограниче-
ний), определяет спи-
сок столбцов, образую-
щих ограничение
confkey int2[] pg_attribute .attnum Для внешнего клю-
ча определяет список
столбцов, на которые
он ссылается
conpfeqop oid[] pg_operator .oid Для внешнего ключа
список операторов ра-
венства для сравнений
PK = FK
conppeqop oid[] pg_operator .oid Для внешнего ключа
список операторов ра-
венства для сравнений
PK = PK
conffeqop oid[] pg_operator .oid Для внешнего ключа
список операторов ра-
венства для сравнений
FK = FK
conexclop oid[] pg_operator .oid Для
ограничения-ис-
ключения список опе-
1944
Описание
= каскадное действие (
cascade), n = присвоить
NULL, d = поведение по
умолчаниюСистемные каталоги
Имя Тип
Ссылки
Описание
раторов исключения по
столбцам
conbin pg_node_tree Для ограничения-про-
верки внутреннее пред-
ставление выражения
consrc text Для ограничения-про-
верки понятное челове-
ку представление выра-
жения
В случае с ограничением-исключением значение conkey полезно только для элементов ограниче-
ний, представляющих простые ссылки на столбцы. Для других случаев в conkey задаётся ноль,
и чтобы получить выражение, определяющее ограничение, надо обратиться к соответствующему
индексу. (Таким образом, поле conkey имеет то же содержимое, что и pg_index.indkey для индек-
са.)
Примечание
Поле consrc не меняется при изменении задействованных в выражении объектов; на-
пример, в нём не отслеживается переименование столбцов. Поэтому лучше не пола-
гаться на него, а воспользоваться функцией pg_get_constraintdef(), чтобы получить
определение ограничения-проверки.
Примечание
Поле pg_class.relchecks должно согласовываться с числом ограничений-проверок,
описанных в данной таблице для каждого отношения.
52.14. pg_conversion
В каталоге pg_conversion описываются функции преобразования кодировки. За дополнительными
сведениями обратитесь к CREATE CONVERSION.
Таблица 52.14. Столбцы pg_conversion
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
conname name Имя перекодировки (
уникальное в простран-
стве имён)
connamespace oid pg_namespace .oid OID
пространства
имён, содержащего эту
перекодировку
conowner oid pg_authid .oid Владелец перекодиров-
ки
conforencoding int4 Идентификатор исход-
ной кодировки
contoencoding int4 Идентификатор
вой кодировки
1945
Описание
целе-Системные каталоги
Имя Тип Ссылки Описание
conproc regproc pg_proc .oid Функция
ния
condefault bool
преобразова-
True, если это переко-
дировка по умолчанию
52.15. pg_database
В каталоге pg_database хранится информация о доступных базах данных. Базы данных создаются
командой CREATE DATABASE. Подробнее о предназначении некоторых свойств баз можно узнать
в Главе 22.
В отличие от большинства системных каталогов, pg_database разделяется всеми базами данных
кластера: есть только один экземпляр pg_database в кластере, а не отдельные в каждой базе дан-
ных.
Таблица 52.15. Столбцы pg_database
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
datname name Имя базы данных
datdba oid encoding int4 Кодировка
символов
для этой базы дан-
ных
(pg_encoding_
to_char()
может
преобразовать этот но-
мер в имя кодировки)
datcollate name LC_COLLATE для этой
базы данных
datctype name LC_CTYPE для этой ба-
зы данных
datistemplate bool Если true, базу дан-
ных
сможет
клони-
ровать любой поль-
зователь с правами
CREATEDB; в против-
ном случае, клониро-
вать эту базу смогут
только суперпользова-
тели и её владелец.
datallowconn bool Если false, никто не
сможет подключаться к
этой базе данных. Это
позволяет защитить ба-
зу данных template0 от
модификаций.
datconnlimit int4 Задаёт максимально до-
пустимое число одно-
временных подключе-
pg_authid .oid
1946
Описание
Владелец базы данных,
обычно пользователь,
создавший еёСистемные каталоги
Имя Тип
Ссылки
datlastsysoid oid Последний системный
OID в базе данных; в
частности, полезен для
pg_dump
datfrozenxid xid Все
идентификаторы
транзакций,
предше-
ствующие данному, в
этой базе данных заме-
нены постоянным («за-
мороженным») иденти-
фикатором транзакции.
Это нужно для опре-
деления, когда тре-
буется очищать базу
данных для предотвра-
щения
зацикливания
идентификаторов или
для сокращения объё-
ма pg_xact . Это зна-
чение вычисляется как
минимум значений pg_
class .relfrozenxid
для всех таблиц.
datminmxid xid Идентификаторы муль-
титранзакций, предше-
ствующие данному, в
этой базе данных за-
менены другим иденти-
фикатором транзакции.
Это нужно для опре-
деления, когда тре-
буется очищать базу
данных для предот-
вращения зациклива-
ния идентификаторов
мультитранзакций или
для сокращения объёма
pg_multixact . Это зна-
чение вычисляется как
минимум значений pg_
class .relminmxid для
всех таблиц.
dattablespace oid
pg_tablespace .oid
1947
Описание
ний к этой базе данных.
С -1 ограничения нет.
Табличное
простран-
ство
по
умолчанию
для данной базы дан-
ных.
Если
табли-
ца
базы
находится
в этом пространстве,
для неё значение pg_
class .reltablespace
будет нулевым; в част-
ности, в нём окажутсяСистемные каталоги
Имя Тип
datacl aclitem[]
Ссылки
Описание
все частные системные
каталоги этой базы.
Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
52.16. pg_db_role_setting
В каталоге pg_db_role_setting записываются значения по умолчанию, присваиваемые перемен-
ным конфигурации во время выполнения, для различных комбинаций ролей и баз данных.
В отличие от большинства системных каталогов, pg_db_role_setting разделяется всеми базами
данных кластера: есть только один экземпляр pg_db_role_setting в кластере, а не отдельные в
каждой базе данных.
Таблица 52.16. Столбцы pg_db_role_setting
Имя Тип Ссылки Описание
setdatabase oid pg_database .oid OID базы данных, к
которой относится это
присвоение
перемен-
ных, или ноль, если оно
не связано с базой дан-
ных
setrole oid pg_authid .oid OID роли, к которой
применимо это присво-
ение переменных, или
ноль, если оно не связа-
но с ролью
setconfig text[]
Значения по умолча-
нию для переменных
конфигурации времени
выполнения
52.17. pg_default_acl
В каталоге pg_default_acl хранятся определения прав, изначально присваиваемые создаваемым
объектам.
Таблица 52.17. Столбцы pg_default_acl
Имя Тип
Ссылки
Описание
oid oid defaclrole oid pg_authid .oid OID роли, связанной с
этой записью
defaclnamespace oid pg_namespace .oid OID
пространства
имён, связанного с этой
записью, или 0, если за-
пись глобальная
defaclobjtype char
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
Тип
объекта,
права
для которого определя-
ет эта запись: r = от-
1948Системные каталоги
Имя Тип
defaclacl aclitem[]
Ссылки
Описание
ношение (relation) (таб-
лица, представление), S
= последовательность (
sequence), f = функ-
ция (function), T = тип
(type), n = схема (
schema)
Права доступа, назна-
чаемые объекту данно-
го типа при создании
В каталоге pg_default_acl описываются начальные права доступа, которые будут связаны с объ-
ектом, принадлежащим заданному пользователю. В настоящее время есть два типа записей: «гло-
бальные», с defaclnamespace = 0, и «внутрисхемные», относящиеся к конкретной схеме. Если при-
сутствует глобальная запись, она переопределяет обычный жёстко фиксированный набор прав
для данного типа объектов. Если присутствует внутрисхемная запись, она представляет набор
прав, добавляемый к набору прав, определённых глобально или жёстко заданных по умолчанию.
Заметьте, что когда поле ACL в другом каталоге содержит NULL, под этим подразумеваются жёст-
ко заданные права по умолчанию для этого объекта, а не те, которые могут быть в pg_default_acl
в данный момент. Права в pg_default_acl учитываются только при создании объекта.
52.18. pg_depend
В каталоге pg_depend записываются отношения зависимости между объектами базы данных. Бла-
годаря этой информации, команды DROP могут найти, какие объекты должны удаляться при ис-
пользовании DROP CASCADE, или когда нужно запрещать удаление при DROP RESTRICT.
Также смотрите описание каталога pg_shdepend, который играет подобную роль в отношении сов-
местно используемых объектов в кластере баз данных.
Таблица 52.18. Столбцы pg_depend
Имя Тип Ссылки Описание
classid oid pg_class .oid OID системного катало-
га, в котором находится
зависимый объект
objid oid любой столбец OID OID определённого за-
висимого объекта
objsubid int4 refclassid oid pg_class .oid OID системного катало-
га, в котором находится
вышестоящий объект
refobjid oid любой столбец OID OID определённого вы-
шестоящего объекта
refobjsubid int4
Для столбца таблицы
это номер столбца (
objid и classid указы-
вают на саму таблицу).
Для всех других типов
объектов это поле со-
держит ноль.
Для столбца таблицы
это номер столбца (
refobjid и refclassid
указывают на саму таб-
1949Системные каталоги
Имя Тип
deptype char
Ссылки
Описание
лицу). Для всех других
типов объектов это по-
ле содержит ноль.
Код,
определяющий
конкретную семантику
данного отношения за-
висимости; см. текст
Во всех случаях, запись в pg_depend показывает, что вышестоящий объект нельзя удалить, не
удаляя подчинённый объект. Однако есть несколько подвидов зависимости, задаваемых в поле
deptype:
DEPENDENCY_NORMAL (n)
Обычное отношение между отдельно создаваемыми объектами. Подчинённый объект можно
удалить, не затрагивая вышестоящий объект. Вышестоящий объект можно удалить только с
указанием CASCADE, при этом будет удалён и подчинённый объект. Например, столбец таблицы
находится в обычной зависимости от своего типа данных.
DEPENDENCY_AUTO (a)
Подчинённый объект может быть удалён отдельно от вышестоящего и должен быть удалён ав-
томатически (вне зависимости от указаний RESTRICT и CASCADE), если удаляется вышестоящий
объект. Например, именованное ограничение для таблицы находится в автоматической зави-
симости от таблицы, так что оно исчезнет при удалении таблицы.
DEPENDENCY_INTERNAL (i)
Подчинённый объект был создан в процессе создания вышестоящего и на самом деле являет-
ся только частью его внутренней реализации. Для такого объекта будет запрещена команда
DROP (мы подскажем пользователю, что вместо этого надо выполнить DROP вышестоящий объ-
ект). Действие DROP для вышестоящего объекта будет распространено и на этот подчинённый
объект, вне зависимости от присутствия указания CASCADE. Например, триггер, созданный для
обеспечения ограничения внешнего ключа, становится внутренне зависимым от записи огра-
ничения в pg_constraint.
DEPENDENCY_INTERNAL_AUTO (I)
Подчинённый объект был создан в процессе создания вышестоящего и на самом деле являет-
ся только частью его внутренней реализации. Для такого объекта будет запрещена команда
DROP (мы подскажем пользователю, что вместо неё надо выполнить DROP для вышестоящего
объекта). Тогда как обычная внутренняя зависимость не позволит удалить зависимый объект,
пока существуют такие зависимости, с DEPENDENCY_INTERNAL_AUTO будет выполнено удаление
объектов, которые могут найтись по цепочке этих зависимостей. Например, индекс в секции
становится автоматически внутренне зависимым и от самой секции, и от индекса родительской
секционированной таблицы; поэтому секционированный индекс удаляется вместе с секцией,
которую он индексирует, либо с родительским индексом, к которому он присоединён.
DEPENDENCY_EXTENSION (e)
Подчинённый объект входит в состав расширения, которое является вышестоящим объек-
том (см. pg_extension). Удалить подчинённый объект можно, только выполнив команду DROP
EXTENSION для вышестоящего объекта. Функционально этот тип зависимости действует так же,
как и внутренняя зависимость, но он выделен для наглядности и упрощения pg_dump.
DEPENDENCY_AUTO_EXTENSION (x)
Подчинённый объект не входит в состав расширения, которое является вышестоящим объектом
(и поэтому не должен игнорироваться утилитой pg_dump), но не может функционировать без
него, и поэтому должен удаляться при удалении расширения. При этом подчинённый объект
может быть удалён и сам по себе.
1950Системные каталоги
DEPENDENCY_PIN (p)
Зависимый объект отсутствует; этот тип записи показывает, что система сама зависит от выше-
стоящего объекта, так что этот объект нельзя удалять ни при каких условиях. Записи этого типа
создаются только командой initdb. Поля зависимого объекта в такой записи содержат нули.
В будущем могут появиться и другие подвиды зависимости.
52.19. pg_description
В каталоге pg_description хранятся дополнительные описания (комментарии) для объектов баз
данных. Описания можно задавать с помощью команды COMMENT и просматривать в psql, исполь-
зуя команды \d. В начальном содержимом pg_description представлены описания многих встро-
енных системных объектов.
Также смотрите каталог pg_shdescription, который играет подобную роль в отношении совместно
используемых объектов в кластере баз данных.
Таблица 52.19. Столбцы pg_description
Имя Тип Ссылки Описание
objoid oid любой столбец OID OID объекта, к которо-
му относится это описа-
ние
classoid oid pg_class .oid OID системного катало-
га, к которому относит-
ся этот объект
objsubid int4 Для комментария к
столбцу таблицы это
номер столбца (objoid
и classoid указывают
на саму таблицу). Для
всех других типов объ-
ектов это поле содер-
жит ноль.
description text Произвольный
текст,
служащий описанием
данного объекта
52.20. pg_enum
В каталоге pg_enum содержатся записи, определяющие значения и метки для всех типов-перечис-
лений. Внутренним представлением значения перечисления на самом деле является OID соответ-
ствующей строки в pg_enum.
Таблица 52.20. Столбцы pg_enum
Имя Тип
oid oid
enumtypid oid
enumsortorder float4
Ссылки
Описание
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pg_type .oid
OID типа в pg_type ,
к которому относится
данное значение пере-
числения
Порядок
сортировки
этого значения внутри
перечисления
1951Системные каталоги
Имя Тип
enumlabel name
Ссылки
Описание
Текстовая метка данно-
го значения перечисле-
ния
Идентификаторы OID в строках pg_enum подчиняются особому правилу: чётные OID гарантирован-
но упорядочиваются по порядку сортировки их типа перечисления. То есть, если к одному пере-
числению относятся два чётных OID, меньшему OID должно соответствовать меньшее значение
enumsortorder. Нечётные значения OID могут быть не связаны с этим порядком сортировки. Это
правило позволяет во многих случаях сравнивать значения перечислений, не обращаясь к катало-
гам. Процедуры, создающие и изменяющие перечисления, пытаются присваивать значениям пе-
речислений чётные OID, если это возможно.
Когда создаётся тип перечисления, его членам назначаются позиции по порядку сортировки
1..n. Но у членов, добавляемых позже, могут оказаться отрицательные или дробные значения
enumsortorder. Единственное, что требуется — чтобы эти значения были правильно упорядочены
и уникальны в рамках перечисления.
52.21. pg_event_trigger
В каталоге pg_event_trigger хранится информация о событийных триггерах. За дополнительными
сведениями обратитесь к Главе 40.
Таблица 52.21. Столбцы pg_event_trigger
Имя Тип
Ссылки
evtname name Имя триггера (должно
быть уникальным)
evtevent name Указывает, для како-
го события срабатывает
данный триггер
evtowner oid pg_authid .oid Владелец событийного
триггера
evtfoid oid pg_proc .oid Вызываемая функция
evtenabled char Устанавливает, в ка-
ких режимах session_
replication_role сраба-
тывает
событийный
триггер: O = триггер
срабатывает в режимах
«origin» (источник) и
«local» (локально), D =
триггер отключён, R =
триггер срабатывает в
режиме «replica» (ре-
плика), A = триггер сра-
батывает всегда.
evttags text[] Теги команд, для кото-
рых будет срабатывать
триггер. Если NULL,
срабатывание триггера
не будет ограничено в
зависимости от тега ко-
манды.
52.22. pg_extension
1952
ОписаниеСистемные каталоги
В каталоге pg_extension хранится информация об установленных расширениях. Подробнее о рас-
ширениях можно узнать в Разделе 38.16.
Таблица 52.22. Столбцы pg_extension
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
extname name Имя расширения
extowner oid pg_authid .oid Владелец расширения
extnamespace oid pg_namespace .oid Схема,
содержащая
экспортируемые
рас-
ширением объекты
extrelocatable bool True, если расширение
можно переместить в
другую схему
extversion text Имя версии расшире-
ния
extconfig oid[] extcondition text[]
pg_class .oid
Описание
Массив с идентифика-
торами regclass, ука-
зывающими на табли-
цы конфигурации рас-
ширения, либо NULL, ес-
ли таких таблиц нет
Массив с условиями
фильтра WHERE для таб-
лиц конфигурации рас-
ширения, либо NULL, ес-
ли таких условий нет
Заметьте, что в отличие от большинства каталогов со столбцом «namespace», здесь extnamespace
не подразумевает, что расширение принадлежит данной схеме. Имена расширений никогда не
дополняются схемой. Вместо этого, extnamespace показывает, что в этой схеме содержатся все или
большинство объектов расширения. Если extrelocatable имеет значение true, эта схема должна
фактически содержать все относящиеся к схеме объекты, составляющие это расширение.
52.23. pg_foreign_data_wrapper
В каталоге pg_foreign_data_wrapper хранятся определения обёрток сторонних данных. Обёрткой
сторонних данных называется механизм, через который становятся доступны внешние данные,
расположенные на сторонних серверах.
Таблица 52.23. Столбцы pg_foreign_data_wrapper
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
fdwname name Имя обёртки сторонних
данных
fdwowner oid pg_authid .oid Владелец обёртки сто-
ронних данных
fdwhandler oid pg_proc .oid Указывает на функ-
цию-обработчик, отве-
1953
ОписаниеСистемные каталоги
Имя Тип Ссылки Описание
чающую за выдачу на-
бора исполняемых про-
цедур для обёртки сто-
ронних данных. Ноль
говорит об отсутствии
такого обработчика
fdwvalidator oid pg_proc .oid Указывает на функ-
цию проверки, кото-
рая отвечает за провер-
ку правильности пара-
метров, передаваемых
обёртке сторонних дан-
ных, а также парамет-
ров для сторонних сер-
веров и сопоставлений
пользователей, задава-
емых через эту обёртку.
Ноль говорит об отсут-
ствии такой функции
fdwacl aclitem[] Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
fdwoptions text[] Специальные парамет-
ры обёртки сторонних
данных, в виде строк
«ключ=значение»
52.24. pg_foreign_server
В каталоге pg_foreign_server хранятся определения сторонних серверов. Запись стороннего сер-
вера описывает источник внешних данных, например удалённый сервер. Обращение к сторонним
серверам происходит через обёртки сторонних данных.
Таблица 52.24. Столбцы pg_foreign_server
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
srvname name Имя стороннего серве-
ра
srvowner oid pg_authid .oid Владелец
сервера
srvfdw oid pg_foreign_data_
wrapper .oid OID обёртки сторонних
данных для этого сто-
роннего сервера
srvtype text Тип сервера (необяза-
телен)
srvversion text Версия сервера (необя-
зательна)
srvacl aclitem[] Права доступа; за по-
дробностями
обрати-
1954
Описание
стороннегоСистемные каталоги
Имя Тип
srvoptions text[]
Ссылки
Описание
тесь к описанию GRANT
и REVOKE
Специальные парамет-
ры стороннего серве-
ра, в виде строк «клю-
ч=значение»
52.25. pg_foreign_table
В каталоге pg_foreign_table содержится дополнительная информация о сторонних таблицах.
Прежде всего сторонняя таблица представляется записью в pg_class, как и обычная. Запись в
pg_foreign_table для неё содержит свойства, применимые только к сторонним таблицам, но не к
каким-либо другим типам отношений.
Таблица 52.25. Столбцы pg_foreign_table
Имя Тип Ссылки Описание
ftrelid oid pg_class .oid OID записи в pg_class
для этой сторонней таб-
лицы
ftserver oid pg_foreign_
server .oid OID стороннего сервера
для этой сторонней таб-
лицы
ftoptions text[]
Параметры сторонней
таблицы, в виде строк
«ключ=значение»
52.26. pg_index
В каталоге pg_index содержится часть информации об индексах. Остальная информация в основ-
ном находится в pg_class.
Таблица 52.26. Столбцы pg_index
Имя Тип Ссылки Описание
indexrelid oid pg_class .oid OID записи в pg_class
для этого индекса
indrelid oid pg_class .oid OID записи в pg_class
для таблицы, к которой
относится этот индекс
indnatts int2 Общее число столб-
цов в индексе (по-
вторяет значение pg_
class.relnatts ). В это
число входят и ключе-
вые, и включённые ат-
рибуты.
indnkeyatts int2 Число ключевых атри-
бутов в индексе, без
учёта включённых ат-
рибутов, которые хра-
нятся в индексе, но не
учитываются в его се-
мантике
1955Системные каталоги
Имя Тип
Ссылки
indisunique bool Если true, это уникаль-
ный индекс
indisprimary bool Если true, этот ин-
декс представляет пер-
вичный ключ таблицы (
в этом случае и в по-
ле indisunique должно
быть значение true)
indisexclusion bool Если true, этот индекс
поддерживает ограни-
чение-исключение
indimmediate bool Если
true,
провер-
ка уникальности осу-
ществляется непосред-
ственно при добавле-
нии данных (неприме-
нимо, если значение
indisunique не true)
indisclustered bool Если true, таблица в по-
следний раз кластери-
зовалась по этому ин-
дексу
indisvalid bool Если true, индекс мож-
но применять в за-
просах. Значение false
означает, что индекс,
возможно, неполный:
он будет, тем не менее,
изменяться командами
INSERT/UPDATE, но без-
опасно применять его в
запросах нельзя. Если
он уникальный, свой-
ство уникальности так
же не гарантируется.
indcheckxmin bool Если
true,
запросы
не должны использо-
вать этот индекс, по-
ка поле xmin дан-
ной
записи
в
pg_
index не окажется ни-
же их горизонта собы-
тий TransactionXmin,
так как таблица может
содержать оборванные
цепочки HOT, с види-
мыми несовместимыми
строками
indisready bool Если true, индекс готов
к добавлению данных.
Значение false озна-
чает, что индекс иг-
1956
ОписаниеСистемные каталоги
Имя Тип
Ссылки
indislive bool Если false, индекс нахо-
дится в процессе удале-
ния и его следует иг-
норировать для любых
целей (включая вопрос
применимости HOT)
indisreplident bool Если true, этот ин-
декс выбран в ка-
честве «идентификато-
ра реплики» командой
ALTER
TABLE
...
REPLICA
IDENTITY
USING INDEX ...
indkey int2vector pg_attribute .attnum Это массив из indnatts
значений,
указываю-
щих, какие столбцы
таблицы индексирует
этот индекс. Например,
значения 1
3 будут
означать, что в индекс
входят первый и тре-
тий столбцы таблицы.
Ключевые столбцы ука-
зываются перед неклю-
чевыми (включёнными)
столбцами. Ноль в этом
массиве означает, что
соответствующий атри-
бут индекса определя-
ется выражением со
столбцами таблицы, а
не просто ссылкой на
столбец.
indcollation oidvector pg_collation .oid Для каждого столб-
ца в ключе индек-
са этот массив (из
indnkeyatts значений)
содержит OID правила
сортировки для приме-
нения в этом индексе
либо 0, если тип данных
этого столбца не сорти-
руемый.
indclass oidvector pg_opclass .oid Для каждого столб-
ца в ключе индек-
са этот массив (из
indnkeyatts значений)
содержит OID применя-
емых классов операто-
ров. Подробнее это рас-
сматривается в описа-
нии pg_opclass .
1957
Описание
норируется операция-
ми INSERT/UPDATE.Системные каталоги
Имя Тип
Ссылки
Описание
indoption int2vector Это
массив
из
indnkeyatts значений,
в которых хранятся би-
товые флаги для от-
дельных столбцов. Зна-
чение
этих
флагов
определяет метод до-
ступа индекса.
indexprs pg_node_tree Деревья выражений (в
представлении
nodeToString() ) для
атрибутов индекса, не
являющихся простыми
ссылками на столбцы.
Этот список содержит
один элемент для каж-
дого нулевого значе-
ния в indkey. Значени-
ем может быть NULL,
если все атрибуты ин-
декса представляют со-
бой простые ссылки.
indpred pg_node_tree Дерево выражения (в
представлении
nodeToString() ) для
предиката частичного
индекса, либо NULL, ес-
ли это не частичный ин-
декс.
52.27. pg_inherits
В каталоге pg_inherits содержится информация об иерархиях наследования таблиц. Для каждой
непосредственной связи «родительская-дочерняя таблица» в ней содержится одна запись. (Кос-
венное наследование можно определить, просмотрев цепочку записей.)
Таблица 52.27. Столбцы pg_inherits
Имя Тип Ссылки Описание
inhrelid oid pg_class .oid OID дочерней таблицы
inhparent oid pg_class .oid OID родительской таб-
лицы
inhseqno int4
Если у дочерней таб-
лицы есть несколько
непосредственных ро-
дителей (множествен-
ное наследование), это
число определяет поря-
док, в котором распо-
лагаются наследован-
ные столбцы. Нумера-
ция начинается с 1.
52.28. pg_init_privs
1958Системные каталоги
В каталоге pg_init_privs содержится информация об изначально назначаемых правах для объек-
тов в системе. Для каждого объекта в базе данных, имеющего нестандартный (отличный от NULL)
начальный набор прав, в ней содержится одна запись.
Начальные права доступа для объектов могут задаваться либо при инициализации базы данных
(программой initdb), либо когда объект создаётся в процессе CREATE EXTENSION и скрипт расшире-
ния задаёт права, задействуя систему GRANT. Заметьте, что эта система автоматически записывает
права, устанавливаемые скриптом расширения, так что авторам расширений достаточно исполь-
зовать в своих скриптах только GRANT и REVOKE, чтобы права были сохранены. Столбец privtype
показывает, были ли начальные права заданы программой initdb или в процессе выполнения ко-
манды CREATE EXTENSION.
Для объектов, которым начальные права были назначены программой initdb, записи в privtype
помечаются буквой 'i', а для объектов, которым права назначались в процессе CREATE EXTENSION,
— буквой 'e'.
Таблица 52.28. Столбцы pg_init_privs
Имя Тип Ссылки Описание
objoid oid любой столбец OID OID определённого объ-
екта
classoid oid pg_class .oid OID системного катало-
га, в котором находится
объект
objsubid int4 Для столбца таблицы
это номер столбца (
objoid и classoid ука-
зывают на саму табли-
цу). Для всех других ти-
пов объектов это поле
содержит ноль.
privtype char Код,
определяющий
тип начального права
для объекта; см. текст
initprivs aclitem[] Начальные права до-
ступа; за подробностя-
ми обратитесь к описа-
нию GRANT и REVOKE
52.29. pg_language
В каталоге pg_language регистрируются языки, на которых возможно писать функции или храни-
мые процедуры. За дополнительной информацией о языковых обработчиках обратитесь к описа-
нию CREATE LANGUAGE и Главе 42.
Таблица 52.29. Столбцы pg_language
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
lanname name Имя языка
lanowner oid lanispl bool
pg_authid .oid
Описание
Владелец языка
Для внутренних языков
(например, SQL) содер-
жит false, а для поль-
1959Системные каталоги
Имя Тип
Ссылки
Описание
зовательских языков —
true. В настоящее вре-
мя, pg_dump всё ещё
пользуется этим при-
знаком, чтобы опреде-
лить, какие языки нуж-
но выгружать, но в бу-
дущем ему на смену мо-
жет прийти другой ме-
ханизм.
lanpltrusted bool lanplcallfoid oid pg_proc .oid Для не внутренних язы-
ков это значение указы-
вает на языковой обра-
ботчик, который пред-
ставляет собой специ-
альную функцию, от-
вечающую за выполне-
ние всех процедур, на-
писанных на этом язы-
ке
laninline oid pg_proc .oid Это значение указыва-
ет на функцию, отве-
чающую за выполнение
«внедрённых» аноним-
ных блоков кода (бло-
ков DO). Ноль, если
внедрённые блоки не
поддерживаются.
lanvalidator oid pg_proc .oid Это значение указыва-
ет на функцию провер-
ки языка, которая отве-
чает за проверку син-
таксиса и правильности
новых функций в мо-
мент их создания. Ноль,
если функция проверки
отсутствует.
lanacl aclitem[]
True, если это доверен-
ный язык, что озна-
чает, что можно рас-
считывать на то, что
он не открывает доступ
куда-либо за пределы
обычной среды испол-
нения SQL. Создавать
функции на недоверен-
ных языках могут толь-
ко суперпользователи.
Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
52.30. pg_largeobject
1960Системные каталоги
В каталоге pg_largeobject содержатся данные, образующие «большие объекты». Большой объект
идентифицируется по OID, назначаемому при его создании. Каждый большой объект разделяется
на сегменты или «страницы», достаточно небольшие для удобного размещения в строках таблицы
pg_largeobject. Объём данных на странице определяется как LOBLKSIZE (что в настоящее время
составляет BLCKSZ/4, то есть обычно 2 Кб).
До PostgreSQL 9.0 большие объекты не были связаны с механизмом разрешений. В результате
таблица pg_largeobject была доступны на чтение для всех и через неё можно было получить OID
(и содержимое) всех больших объектов в системе. Теперь это не так; для получения списка OID
больших объектов нужно обратиться к pg_largeobject_metadata.
Таблица 52.30. Столбцы pg_largeobject
Имя Тип Ссылки Описание
loid oid pg_largeobject_
metadata .oid Идентификатор боль-
шого объекта, включа-
ющего эту страницу
pageno int4 Номер этой страницы в
большом объекте (начи-
ная с нуля)
data bytea Собственно
данные,
хранящиеся в боль-
шом объекте. Их объ-
ём не может превы-
шать LOBLKSIZE, но мо-
жет быть меньше.
В каждой строке pg_largeobject содержатся данные для одной строки большого объекта, начиная
со смещения (pageno * LOBLKSIZE) внутри него (в байтах). Эта реализация допускает разрежен-
ное хранилище: страницы могут отсутствовать и могут быть короче LOBLKSIZE, даже если это не
последние страницы объектов. Пропущенные области в большом объекте будут считываться как
нулевые.
52.31. pg_largeobject_metadata
В каталоге pg_largeobject_metadata содержатся метаданные, связанные с большими объектами.
Собственно данные больших объектов хранятся в pg_largeobject.
Таблица 52.31. Столбцы pg_largeobject_metadata
Имя Тип
oid oid
lomowner oid
lomacl aclitem[]
Ссылки
Описание
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pg_authid .oid
Владелец
объекта
большого
Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
52.32. pg_namespace
В pg_namespace сохраняются пространства имён. Пространство имён представляет собой структу-
ру, на которой основываются схемы SQL: в каждом пространстве имён без конфликтов может су-
ществовать отдельный набор отношений, типов и т. д.
1961Системные каталоги
Таблица 52.32. Столбцы pg_namespace
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
nspname name Имя пространства имён
nspowner oid nspacl aclitem[]
pg_authid .oid
Описание
Владелец пространства
имён
Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
52.33. pg_opclass
В каталоге pg_opclass определяются классы операторов для методов доступа индексов. Каждый
класс операторов устанавливает конкретную операцию для индексируемых столбцов определён-
ного типа данных и определённого метода доступа. Класс операторов по сути устанавливает, что
некоторое семейство операторов применимо к определённому индексируемому типу столбца. На-
бор операторов из семейства, которые действительно можно использовать с индексируемым столб-
цом, образуют те, что принимают тип данных столбца в качестве левого операнда.
Классы операторов углублённо рассматриваются в Разделе 38.15.
Таблица 52.33. Столбцы pg_opclass
Имя Тип
Ссылки
Описание
oid oid opcmethod oid opcname name opcnamespace oid pg_namespace .oid Пространство имён это-
го класса операторов
opcowner oid pg_authid .oid Владелец класса опера-
торов
opcfamily oid pg_opfamily .oid Семейство операторов,
содержащее этот класс
операторов
opcintype oid pg_type .oid Тип данных, индексиру-
емый данным классом
операторов
opcdefault bool opckeytype oid
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pg_am .oid
Метод доступа индек-
са, для которого создан
этот класс операторов
Имя этого класса опе-
раторов
True, если этот класс
операторов применяет-
ся по умолчанию для
opcintype
pg_type .oid
1962
Тип данных, хранимых
в индексе, или ноль,
если он совпадает с
opcintypeСистемные каталоги
Значение opcmethod класса операторов должно совпадать с opfmethod для содержащего его се-
мейства операторов. Кроме того, должно быть не больше одной строки в pg_opclass, в которой
opcdefault равно true для любой данной комбинации opcmethod и opcintype.
52.34. pg_operator
В каталоге pg_operator хранится информация об операторах. За дополнительными сведениями
обратитесь к описанию CREATE OPERATOR и Разделу 38.13.
Таблица 52.34. Столбцы pg_operator
Имя Тип
Ссылки
Описание
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
oprname name Имя оператора
oprnamespace oid pg_namespace .oid OID
пространства
имён,
содержащего
этот оператор
oprowner oid pg_authid .oid Владелец оператора
oprkind char b
=
инфиксный
(
«both»), l = префикс-
ный («left»), r = пост-
фиксный («right»)
oprcanmerge bool Этот
оператор
под-
держивает соединение
слиянием
oprcanhash bool Этот оператор поддер-
живает соединение по
хешу
oprleft oid pg_type .oid Тип левого операнда
oprright oid pg_type .oid Тип правого операнда
oprresult oid pg_type .oid Тип результата
oprcom oid pg_operator .oid Коммутирующий
для
данного оператор, если
есть
oprnegate oid pg_operator .oid Обратный для данного
оператор, если есть
oprcode regproc pg_proc .oid Функция, реализующая
этот оператор
oprrest regproc pg_proc .oid Функция оценки изби-
рательности ограниче-
ния для данного опера-
тора
oprjoin regproc pg_proc .oid Функция оценки изби-
рательности соедине-
ния для данного опера-
тора
Неиспользуемые поля содержат нули. Например, поле oprleft будет содержать ноль для префикс-
ного оператора.
52.35. pg_opfamily
1963Системные каталоги
В каталоге pg_opfamily определяются семейства операторов. Каждое семейство операторов пред-
ставляет собой набор операторов и связанных с ними опорных процедур, реализующих операции,
требуемые для определённого метода доступа. Более того, все операторы в семействе являются
«совместимыми», в том смысле, который определяется методом доступа. Концепция семейства
операторов позволяет использовать в индексах операторы смешанных типов и рассматривать их,
используя знание семантики метода доступа.
Семейства операторов углублённо рассматриваются в Разделе 38.15.
Таблица 52.35. Столбцы pg_opfamily
Имя Тип
Ссылки
Описание
oid oid opfmethod oid opfname name opfnamespace oid pg_namespace .oid Пространство имён се-
мейства операторов
opfowner oid pg_authid .oid Владелец
операторов
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pg_am .oid
Метод доступа индекса,
для которого предна-
значено семейство опе-
раторов
Имя семейства опера-
торов
семейства
Основная часть информации, определяющей семейство операторов, находится не в строке
pg_opfamily, а в связанных строках в pg_amop, pg_amproc и pg_opclass.
52.36. pg_partitioned_table
В каталоге pg_partitioned_table хранится информация о секционировании таблиц.
Таблица 52.36. Столбцы pg_partitioned_table
Имя Тип Ссылки Описание
partrelid oid pg_class .oid OID записи в pg_class
для этой секциониро-
ванной таблицы
partstrat char Стратегия секциониро-
вания; h = секциониро-
вание по хешу (Hash), l
= секционирование по
спискам (List), r = сек-
ционирование по диа-
пазонам (Range)
partnatts int2 Число столбцов в ключе
разбиения
partdefid oid
pg_class .oid
1964
OID записи в pg_class
для секции по умолча-
нию в данной секциони-
рованной таблице или
ноль, если в этой сек-
ционированной табли-
це нет секции по умол-
чанию.Системные каталоги
Имя Тип Ссылки Описание
partattrs int2vector pg_attribute .attnum Это
массив
из
partnatts
значений,
указывающих,
какие
столбцы таблицы вхо-
дят в ключ разбиения.
Например, значения 1
3 будут означать, что
ключ разбиения состав-
ляют первый и третий
столбцы таблицы. Ноль
в этом массиве озна-
чает, что соответствую-
щей частью ключа раз-
биения является выра-
жение, а не ссылка на
отдельный столбец.
partclass oidvector pg_opclass .oid Для каждого столбца в
ключе разбиения этот
массив содержит OID
применяемых классов
операторов. Подробнее
это рассматривается в
описании pg_opclass .
partcollation oidvector pg_opclass .oid Для каждого столб-
ца в ключе разбиения
этот массив содержит
OID правила сортиров-
ки для секционирова-
ния либо 0, если тип
данных этого столбца
не сортируемый.
partexprs pg_node_tree
Деревья выражений (в
представлении
nodeToString() ) для
частей ключа разби-
ения, не являющихся
простыми ссылками на
столбцы. Этот список
содержит один элемент
для каждого нулевого
значения в partattrs.
Значением может быть
NULL, если все части
ключа разбиения явля-
ются простыми указа-
ниями столбцов.
52.37. pg_pltemplate
В каталоге pg_pltemplate хранится информация о «шаблонах» для процедурных языков. Шаблон
для языка позволяет создать язык в определённой базе данных простой командой CREATE LANGUAGE,
без необходимости указывать подробности реализации.
В отличие от большинства системных каталогов, pg_pltemplate разделяется всеми базами данных
в кластере: есть только один экземпляр pg_pltemplate в кластере, а не отдельные в базе данных.
1965Системные каталоги
Благодаря этому, к данной информации при необходимости можно обращаться в любой базе дан-
ных.
Таблица 52.37. Столбцы pg_pltemplate
Имя Тип Описание
tmplname name Имя языка, для которого пред-
назначен этот шаблон
tmpltrusted boolean True, если язык считается дове-
ренным
tmpldbacreate boolean True, если язык может быть со-
здан владельцем базы данных
tmplhandler text Имя функции-обработчика вы-
зова
tmplinline text Имя функции-обработчика ано-
нимного кода, либо NULL, если
её нет
tmplvalidator text Имя функции проверки, либо
NULL, если её нет
tmpllibrary text Путь к разделяемой библиоте-
ке, реализующей этот язык
tmplacl aclitem[] Права доступа для шаблона (
фактически не используются)
В настоящее время для управления шаблонами процедурных языков нет никаких команд; чтобы
изменить встроенную информацию, суперпользователь должен модифицировать эту таблицу, вы-
полняя обычные команды INSERT, DELETE или UPDATE.
Примечание
Скорее всего каталог pg_pltemplate будет ликвидирован в каком-нибудь будущем вы-
пуске PostgreSQL, а эти знания о процедурных языках будут храниться в соответству-
ющих скриптах установки расширений.
52.38. pg_policy
В каталоге pg_policy хранятся политики защиты на уровне строк для таблиц. Описание политики
включает тип команды, к которой она применяется (это могут быть все команды), роли, к которым
она применяется, выражение, добавляемое к условию барьера безопасности в запросы, обращаю-
щиеся к таблице, и выражение, добавляемое к условию WITH CHECK в запросы, которые пытаются
добавить в таблицу новые записи.
Таблица 52.38. Столбцы pg_policy
Имя Тип
polname name
polrelid oid
polcmd char
Ссылки
Описание
Имя политики.
pg_class .oid
Таблица, к которой при-
меняется политика
Тип команды, к которой
применяется политика:
r обозначает SELECT, a
— INSERT, w — UPDATE, d
— DELETE, а * — все ко-
манды
1966Системные каталоги
Имя Тип
Ссылки
Описание
polpermissive boolean polroles oid[] polqual pg_node_tree Дерево выражения, до-
бавляемое к условиям
барьера безопасности
в запросы, использую-
щие таблицу
polwithcheck pg_node_tree Дерево выражения, до-
бавляемое к условиям
WITH CHECK в запро-
сы, которые пытаются
добавлять строки в таб-
лицу
Является ли полити-
ка разрешительной или
ограничительной?
pg_authid .oid
Роли, к которым приме-
няется политика.
Примечание
Политики хранятся в pg_policy и применяются только когда для этой таблицы уста-
новлено свойство pg_class.relrowsecurity.
52.39. pg_proc
В каталоге pg_proc хранится информация об обычных функциях, процедурах, агрегатных и окон-
ных функциях (в совокупности также называемых подпрограммами). За дополнительными сведе-
ниями обратитесь к описанию CREATE FUNCTION, CREATE PROCEDURE и Разделу 38.3.
Если prokind указывает, что данная запись описывает агрегатную функцию, в pg_aggregate долж-
на быть соответствующая строка.
Таблица 52.39. Столбцы pg_proc
Имя Тип
Ссылки
Описание
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
proname name Имя функции
pronamespace oid pg_namespace .oid OID
пространства
имён, содержащего эту
функцию
proowner oid pg_authid .oid Владелец функции
prolang oid pg_language .oid Язык реализации или
интерфейс вызова для
этой функции
procost float4
Примерная стоимость
выполнения (в едини-
цах cpu_operator_cost);
если установлен при-
знак proretset, это сто-
имость выдачи одной
строки
1967Системные каталоги
Имя Тип
Ссылки
Описание
prorows float4 provariadic oid pg_type .oid Тип данных элемен-
тов переменного масси-
ва параметров, либо 0,
если функция не прини-
мает переменное число
параметров
protransform regproc pg_proc .oid Вызовы этой функции
могут быть упрощены
заданной функцией (см.
Подраздел 38.10.10)
prokind char f — обычная функция
(Function), p — проце-
дура (Procedure), a —
агрегатная функция (
Aggregate function) или
w — оконная функция (
Window function)
prosecdef bool Функция
определяет
контекст безопасности
(т. е. это функция
«setuid»)
proleakproof bool Функция не имеет по-
бочных эффектов. Ни-
какая информация о
её аргументах не вы-
даётся, кроме как че-
рез возвращаемое зна-
чение. Любая функция,
которая может выдать
ошибку, в зависимости
от значений аргумен-
тов, не является герме-
тичной.
proisstrict bool Функция
возвращает
NULL, если любой из
аргументов при вызо-
ве NULL. В этом слу-
чае функция фактиче-
ски не будет вызы-
ваться вовсе. Функции,
не являющиеся «стро-
гими», должны быть го-
товы принять значения
NULL.
proretset bool Функция
возвращает
множество (т. е. множе-
ство значений указан-
ного типа данных)
Примерное число воз-
вращаемых
строк
(
ноль,
если
признак
proretset не установ-
лен)
1968Системные каталоги
Имя Тип
Ссылки
provolatile char Свойство provolatile
говорит, зависит ли ре-
зультат функции толь-
ко от её входных ар-
гументов, либо на него
влияют внешние факто-
ры. Буквой i обознача-
ются постоянные функ-
ции («immutable»), ко-
торые всегда возвраща-
ют один результат для
одних и тех же аргу-
ментов. Буквой s обо-
значаются стабильные
функции («stable»), ре-
зультаты которых (для
одних и тех же аргу-
ментов) не меняются в
ходе одного сканирова-
ния. Буквой v обознача-
ются изменчивые функ-
ции («volatile»), резуль-
таты которых могут ме-
няться в любое время.
(Так же v следует вы-
бирать для функций с
побочными эффектами,
чтобы система не опти-
мизировала их вызовы.)
proparallel char Свойство proparallel
говорит, может ли эта
функция безопасно вы-
полняться в параллель-
ном режиме. Симво-
лом s в нём обозна-
чаются функции, кото-
рые могут выполнять-
ся в параллельном ре-
жиме без ограничений.
Символом r обознача-
ются функции, кото-
рые могут выполнять-
ся в параллельном ре-
жиме, но только в ве-
дущем процессе груп-
пы; в параллельных ра-
бочих процессах вызы-
вать их нельзя. Сим-
волом u отмечаются
функции небезопасные
в параллельном режи-
ме; присутствие такой
функции влечёт выбор
последовательного пла-
1969
ОписаниеСистемные каталоги
Имя Тип
Ссылки
Описание
на выполнения запро-
са.
pronargs int2 Число входных
ментов
pronargdefaults int2 Число аргументов, для
которых
определены
значения по умолча-
нию
prorettype oid pg_type .oid Тип данных возвращае-
мого значения
proargtypes oidvector pg_type .oid Массив с типами дан-
ных аргументов функ-
ции. В нём учитывают-
ся только входные аргу-
менты функции (вклю-
чая аргументы INOUT и
VARIADIC), так что он
представляет сигнату-
ру вызова функции.
proallargtypes oid[] pg_type .oid Массив с типами дан-
ных аргументов функ-
ции. В нём учитыва-
ются все аргументы (
включая аргументы OUT
и INOUT); однако, если
все аргументы только
входные (IN), это поле
будет содержать NULL.
Заметьте, что индексы
в нём начинаются с 1,
тогда как в proargtypes
по историческим при-
чинами они начинают-
ся с 0.
proargmodes char[]
аргу-
Массив с режимами ар-
гументов функций, за-
кодированными как i
для входных аргумен-
тов (IN), o для выходных
аргументов (OUT), b для
аргументов входных и
выходных одновремен-
но (INOUT), v для пе-
ременных аргументов (
VARIADIC) и t для таб-
личных аргументов (
TABLE). Если все ар-
гументы являются ар-
гументами IN, это по-
ле может содержать
NULL. Заметьте, что ин-
дексы в этом массиве
соответствуют позици-
1970Системные каталоги
Имя Тип
Ссылки
proargnames text[] Массив с именами ар-
гументов функции. Для
аргументов без имени
в этом массиве задают-
ся пустые строки. Ес-
ли все аргументы функ-
ции безымянные, это
поле может содержать
NULL. Заметьте, что ин-
дексы в этом массиве
соответствуют позици-
ям в proallargtypes, а
не в proargtypes.
proargdefaults pg_node_tree Деревья выражений (в
представлении
nodeToString() ) для
значений аргументов
по
умолчанию.
Это
список,
содержащий
pronargdefaults
эле-
ментов, соответствую-
щих последним N вход-
ным аргументам (т. е.,
последним N позици-
ям в proargtypes). Ес-
ли значение по умолча-
нию не имеет никакой
аргумент, это поле мо-
жет содержать NULL.
protrftypes oid[] OID типов данных, к
которым будут приме-
няться трансформации.
prosrc text Это значение говорит
обработчику функции,
как вызывать данную
функцию. Это может
быть собственно ис-
ходный код функции
для интерпретируемых
языков, объектный сим-
вол, имя файла или что-
то другое, в зависимо-
сти от языка реализа-
ции/соглашения о вызо-
вах.
probin text Дополнительная
ин-
формация о том, как
вызывать функцию. Ин-
терпретация этого зна-
чения так же зависит от
языка.
1971
Описание
ям в proallargtypes, а
не в proargtypes.Системные каталоги
Имя Тип
Ссылки
Описание
proconfig text[] Локальные присвоения
конфигурационных пе-
ременных времени вы-
полнения,
действую-
щие в рамках функции
proacl aclitem[] Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
Для скомпилированных функций, как встроенных, так и динамически загружаемых, поле prosrc
содержит имя функции на языке C (объектный символ). Для всех других известных сегодня ти-
пов языков поле prosrc содержит исходный код функции. Поле probin используется только для
динамически загружаемых функций на C, для которых оно задаёт имя разделяемой библиотеки,
содержащей эти функции.
52.40. pg_publication
Каталог pg_publication содержит все публикации, созданные в базе данных. Подробнее о публи-
кациях можно узнать в Разделе 31.1.
Таблица 52.40. Столбцы pg_publication
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pubname name Имя публикации
pubowner oid puballtables bool Если true, эта публи-
кация автоматически
включает все таблицы в
базе данных, в том чис-
ле и те, что будут созда-
ны в будущем.
pubinsert bool Если true, операции
INSERT реплицируются
для таблиц в реплика-
ции.
pubupdate bool Если true, операции
UPDATE реплицируются
для таблиц в публика-
ции.
pubdelete bool Если true, операции
DELETE реплицируются
для таблиц в публика-
ции.
pubtruncate bool Если true, операции
TRUNCATE реплицируют-
ся для таблиц в публи-
кации.
pg_authid .oid
52.41. pg_publication_rel
1972
Описание
Владелец публикацииСистемные каталоги
Каталог pg_publication_rel содержит сопоставления отношений и публикаций в базе данных (это
сопоставления вида многие-ко-многим). Более понятное пользователю представление этой инфор-
мации можно также получить в Разделе 52.78.
Таблица 52.41. Столбцы pg_publication_rel
Имя Тип Ссылки Описание
prpubid oid pg_publication .oid Ссылка на публикацию
prrelid oid pg_class .oid Ссылка на отношение
52.42. pg_range
В каталоге pg_range хранится информация о типах диапазонов. Эта информация дополняет записи
типов в pg_type.
Таблица 52.42. Столбцы pg_range
Имя Тип Ссылки Описание
rngtypid oid pg_type .oid OID типа диапазона
rngsubtype oid pg_type .oid OID типа элемента (
подтипа) данного типа
диапазона
rngcollation oid pg_collation .oid OID правила сортиров-
ки, применяемого для
сравнения диапазонов,
либо 0 в случае его от-
сутствия
rngsubopc oid pg_opclass .oid OID класса операторов
подтипа, применяемого
для сравнения диапазо-
нов
rngcanonical regproc pg_proc .oid OID функции, преобра-
зующей значение диа-
пазона в каноническую
форму, либо 0 в случае
её отсутствия
rngsubdiff regproc pg_proc .oid OID функции, возвра-
щающей разницу меж-
ду значениями двух
элементов в значении
double precision, ли-
бо 0 в случае её отсут-
ствия
Значение rngsubopc (в сочетании с rngcollation, если тип элемента сортируемый) определяет по-
рядок сортировки для типа диапазона. Значение rngcanonical используется, когда тип элемента
дискретный. Значение rngsubdiff может отсутствовать, но его рекомендуется задавать для уве-
личения производительности индексов GiST с диапазонным типом.
52.43. pg_replication_origin
В каталоге pg_replication_origin содержатся все созданные источники репликации. Подробно
источники репликации описаны в Главе 50.
В отличие от большинства системных каталогов, pg_replication_origin разделяется всеми база-
ми данных кластера: есть только один экземпляр pg_replication_origin в кластере, а не отдель-
ные в каждой базе.
1973Системные каталоги
Таблица 52.43. Столбцы pg_replication_origin
Имя Тип
Ссылки
Описание
roident Oid Уникальный в рамках
кластера идентифика-
тор для источника ре-
пликации. Не должен
покидать пределы си-
стемы.
roname text Определяемое пользо-
вателем внешнее имя
источника репликации.
52.44. pg_rewrite
В каталоге pg_rewrite хранятся правила перезаписи для таблиц и представлений.
Таблица 52.44. Столбцы pg_rewrite
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
rulename name Имя правила
ev_class oid ev_type char Тип события, для кото-
рого предназначено это
правило: 1 = SELECT, 2 =
UPDATE, 3 = INSERT, 4 =
DELETE
ev_enabled char Устанавливает, в ка-
ких режимах session_
replication_role сраба-
тывает правило: O =
правило срабатывает в
режимах «origin» (ис-
точник) и «local» (ло-
кально), D = правило
отключено, R = прави-
ло срабатывает в режи-
ме «replica» (реплика),
A = правило срабатыва-
ет всегда.
is_instead bool True, если это правило
INSTEAD
ev_qual pg_node_tree Дерево выражения (
в форме представле-
ния nodeToString() )
для условия примене-
ния правила
ev_action pg_node_tree Дерево
запроса
(в
форме представления
nodeToString() ) для
действия правила
pg_class .oid
1974
Описание
Таблица, к которой от-
носится это правилоСистемные каталоги
Примечание
Если для таблицы есть какие-либо правила
pg_class.relhasrules для неё должно быть true.
в
этом
каталоге,
значением
52.45. pg_seclabel
В каталоге pg_seclabel хранятся метки безопасности для объектов баз данных. Управлять метка-
ми безопасности можно с помощью команды SECURITY LABEL. Более простой способ просмотра
меток безопасности описан в Разделе 52.83.
Также обратите внимание на каталог pg_shseclabel, который выполняет ту же функцию для меток
безопасности глобальных объектов в кластере баз данных.
Таблица 52.45. Столбцы pg_seclabel
Имя Тип Ссылки Описание
objoid oid любой столбец OID OID объекта, к которо-
му относится эта метка
безопасности
classoid oid pg_class .oid OID системного катало-
га, к которому относит-
ся этот объект
objsubid int4 Для метки безопас-
ности, связанной со
столбцом таблицы, это
номер столбца (objoid
и classoid указывают
на саму таблицу). Для
всех других типов объ-
ектов это поле содер-
жит ноль.
provider text Поставщик меток без-
опасности, связанный с
этой меткой.
label text Метка
безопасности,
применённая к этому
объекту.
52.46. pg_sequence
В каталоге pg_sequence содержится информация о последовательностях. Некоторая информация
о последовательностях, в частности имя и схема, хранится в pg_class.
Таблица 52.46. Столбцы pg_sequence
Имя Тип Ссылки Описание
seqrelid oid pg_class .oid OID записи в pg_class
для этой последова-
тельности
seqtypid oid pg_type .oid Тип данных последова-
тельности
seqstart int8
Начальное
значение
последовательности
1975Системные каталоги
Имя Тип
Ссылки
Описание
seqincrement int8 Шаг увеличения после-
довательности
seqmax int8 Максимальное значе-
ние последовательно-
сти
seqmin int8 Минимальное значение
последовательности
seqcache int8 Размер кеша последо-
вательности
seqcycle bool Зацикливается ли по-
следовательность
52.47. pg_shdepend
В каталоге pg_shdepend записываются отношения зависимости между объектами баз данных и
разделяемыми объектами, такими как роли. Эта информация позволяет PostgreSQL удостоверить-
ся, что эти объекты не используется, прежде чем удалять их.
Также смотрите каталог pg_depend, который играет подобную роль в отношении зависимостей
объектов в одной базе данных.
В отличие от большинства системных каталогов, pg_shdepend разделяется всеми базами данных
кластера: есть только один экземпляр pg_shdepend в кластере, а не отдельные в каждой базе дан-
ных.
Таблица 52.47. Столбцы pg_shdepend
Имя Тип Ссылки Описание
dbid oid pg_database .oid OID базы данных, в
которой находится за-
висимый объект, или
ноль, если это глобаль-
ный объект
classid oid pg_class .oid OID системного катало-
га, в котором находится
зависимый объект
objid oid любой столбец OID OID определённого за-
висимого объекта
objsubid int4 refclassid oid pg_class .oid OID системного катало-
га, к которому относит-
ся вышестоящий объ-
ект (это должен быть
разделяемый каталог)
refobjid oid любой столбец OID OID определённого вы-
шестоящего объекта
Для столбца таблицы
это номер столбца (
objid и classid указы-
вают на саму таблицу).
Для всех других типов
объектов это поле со-
держит ноль.
1976Системные каталоги
Имя Тип
deptype char
Ссылки
Описание
Код,
определяющий
конкретную семантику
данного отношения за-
висимости; см. текст
Во всех случаях, запись в pg_shdepend показывает, что вышестоящий объект нельзя удалить, не
удаляя подчинённый объект. Однако есть несколько подвидов зависимости, задаваемых в поле
deptype:
SHARED_DEPENDENCY_OWNER (o)
Вышестоящий объект (это должна быть роль) является владельцем зависимого объекта.
SHARED_DEPENDENCY_ACL (a)
Вышестоящий объект (это должна быть роль) упоминается в ACL (списке управления доступом,
то есть списке прав) подчинённого объекта. (Запись SHARED_DEPENDENCY_ACL не создаётся для
владельца объекта, так как для владельца всё равно имеется запись SHARED_DEPENDENCY_OWNER.)
SHARED_DEPENDENCY_POLICY (r)
Вышестоящий объект (это должна быть роль) упомянут в качестве целевого в объекте зависи-
мой политики.
SHARED_DEPENDENCY_PIN (p)
Зависимый объект отсутствует; этот тип записи показывает, что система сама зависит от выше-
стоящего объекта, так что этот объект нельзя удалять ни при каких условиях. Записи этого типа
создаются только командой initdb. Поля зависимого объекта в такой записи содержат нули.
В будущем могут появиться и другие подвиды зависимости. Заметьте в частности, что с текущим
определением вышестоящими объектами могут быть только роли.
52.48. pg_shdescription
В каталоге pg_shdescription хранятся дополнительные описания (комментарии) для глобальных
объектов баз данных. Описания можно задавать с помощью команды COMMENT и просматривать
в psql, используя команды \d.
Также смотрите каталог pg_description, который играет подобную роль в отношении описаний
объектов в одной базе данных.
В отличие от большинства системных каталогов, pg_shdescription разделяется всеми базами дан-
ных кластера: есть только один экземпляр pg_shdescription в кластере, а не отдельные в каждой
базе данных.
Таблица 52.48. Столбцы pg_shdescription
Имя Тип Ссылки Описание
objoid oid любой столбец OID OID объекта, к которо-
му относится это описа-
ние
classoid oid pg_class .oid OID системного катало-
га, к которому относит-
ся этот объект
description text
Произвольный
текст,
служащий описанием
данного объекта
1977Системные каталоги
52.49. pg_shseclabel
В каталоге pg_shseclabel хранятся метки безопасности для глобальных объектов баз данных.
Управлять метками безопасности можно с помощью команды SECURITY LABEL. Более простой
способ просмотра меток безопасности описан в Разделе 52.83.
Также смотрите каталог pg_seclabel, который играет подобную роль в отношении меток безопас-
ности объектов в одной базе данных.
В отличие от большинства системных каталогов, pg_shseclabel разделяется всеми базами данных
кластера: есть только один экземпляр pg_shseclabel в кластере, а не отдельные в каждой базе
данных.
Таблица 52.49. Столбцы pg_shseclabel
Имя Тип Ссылки Описание
objoid oid любой столбец OID OID объекта, к которо-
му относится эта метка
безопасности
classoid oid pg_class .oid OID системного катало-
га, к которому относит-
ся этот объект
provider text Поставщик меток без-
опасности, связанный с
этой меткой.
label text Метка
безопасности,
применённая к этому
объекту.
52.50. pg_statistic
В каталоге pg_statistic хранится статистическая информация о содержимом базы данных. Запи-
си в нём создаются командой ANALYZE, а затем используются планировщиком запросов. Заметьте,
что все эти данные по природе своей неточные, даже если предполагается, что они актуальны.
Обычно для каждого столбца, подлежащего анализу, в этом каталоге есть одна запись со значе-
нием stainherit = false. Если у таблицы имеются потомки в иерархии наследования, также со-
здаётся вторая запись с stainherit = true. Эта строка представляет статистику по столбцу в де-
реве наследования, то есть статистику по данным, которые возвратит запрос SELECT столбец FROM
таблица*, тогда как строка с stainherit = false представляет результаты запроса SELECT столбец
FROM ONLY таблица.
В pg_statistic также хранится статистическая информация о значениях выражений индексов.
Она описывается так же, как если бы это были столбцы данных; в частности, starelid ссылается на
индекс. Однако для столбцов, задействуемых в индексе без выражений, дополнительная запись не
добавляется, так как она повторяла бы запись для нижележащего столбца таблицы. В настоящее
время во всех записях для выражений индексов stainherit = false.
Так как для различных типов данных могут быть уместны различные типы статистики, в каталоге
pg_statistic не делается конкретных предположений о том, какая статистика в нём хранится.
Отдельные столбцы в pg_statistic выделены только для самых общих свойств (например, доля
NULL). Всё остальное хранится в «слотах», представляющих собой группы связанных столбцов,
содержимое которых определяется кодовым числом в одном из столбцов слотов. За подробностями
обратитесь к src/include/catalog/pg_statistic.h.
Каталог pg_statistic не должен быть доступен на чтение всем, так как даже статистическая ин-
формация о содержимом таблицы может считаться конфиденциальной. (Например, довольно ин-
1978Системные каталоги
тересны могут быть минимальные и максимальные значения в столбце зарплаты.) Поэтому суще-
ствует pg_stats — доступное всем для чтения представление на базе pg_statistic, в котором вы-
даётся информация только по тем таблицам, которые может читать текущий пользователь.
Таблица 52.50. Столбцы pg_statistic
Имя Тип Ссылки Описание
starelid oid pg_class .oid Таблица (или индекс),
к которой принадлежит
описываемый столбец
staattnum int2 pg_attribute .attnum Номер
описываемого
столбца
stainherit bool Если true, в статистике
учитываются значения
в дочерних столбцах, а
не только в указанном
отношении
stanullfrac float4 Доля записей, в кото-
рых этот столбец содер-
жит NULL
stawidth int4 Средний размер хра-
нения элементов не-
NULL, в байтах
stadistinct float4 Число различных и от-
личных от NULL зна-
чений в столбце. Чис-
ло, большее нуля, пред-
ставляет фактическое
количество различных
значений. Если это чис-
ло меньше нуля, его мо-
дуль представляет мно-
житель для общего ко-
личества строк в таб-
лице; например, для
столбца, в котором при-
мерно 80% значений
не NULL, и каждое от-
личное от NULL значе-
ние в среднем повто-
ряется дважды, может
быть представлено зна-
чение stadistinct =
-0.4. Ноль означает, что
количество различных
значений неизвестно.
stakindN int2 Кодовое число, опреде-
ляющее род статисти-
ки, хранящейся в N-
ном «слоте» строки pg_
statistic row.
staopN oid
pg_operator .oid
1979
Оператор, с которым
была получена стати-
стика, хранящаяся в
N-ном «слоте». Напри-Системные каталоги
Имя Тип
Ссылки
Описание
мер, для слота гисто-
граммы это будет опе-
ратор &lt;, определяю-
щий порядок сортиров-
ки данных.
stanumbersN float4[] Численная статистика
соответствующего рода
для N-ного «слота», ли-
бо NULL, если с этим
родом слота не связаны
числовые значения
stavaluesN anyarray Значения столбцов со-
ответствующего
рода
для N-го «слота», ли-
бо NULL, если для это-
го рода слота не хра-
нятся никакие значе-
ния. Все значения эле-
ментов массива факти-
чески имеют тип дан-
ных столбца или свя-
занный тип, например,
тип элемента масси-
ва, так что опреде-
лить типы эти столбцов
более конкретно, чем
anyarray, нельзя.
52.51. pg_statistic_ext
Каталог pg_statistic_ext содержит расширенную статистику планировщика. Каждая строка в
этом каталоге соответствует объекту статистики, созданному командой CREATE STATISTICS.
Таблица 52.51. Столбцы pg_statistic_ext
Имя Тип Ссылки Описание
stxrelid oid pg_class .oid Таблица, содержащая
столбцы, описываемые
этим объектом
stxname name stxnamespace oid pg_namespace .oid OID
пространства
имён,
содержащего
этот объект статистики
stxowner oid pg_authid .oid Владелец объекта ста-
тистики
stxkeys int2vector pg_attribute .attnum Массив номеров атри-
бутов, показывающий,
какие столбцы табли-
цы покрываются дан-
ным объектом стати-
стики; например, зна-
чение 1 3 показывает,
что статистика покры-
Имя объекта статисти-
ки
1980Системные каталоги
Имя Тип
Ссылки
Описание
вает первый и третий
столбцы таблицы
stxkind char[] Массив,
содержащий
коды для включённых
видов статистики; допу-
стимые значения: d для
статистики по количе-
ству различных значе-
ний, f для статистики
по функциональным за-
висимостям
stxndistinct pg_ndistinct Количество различных
значений, сериализо-
ванное в типе pg_
ndistinct
stxdependencies pg_dependencies Статистика по функ-
циональным
зависи-
мостям, сериализован-
ная
в
типе
pg_
dependencies
Поле stxkind заполняется при создании объекта статистики и показывает, для какого типа(ов)
статистики он создан. Поля после него изначально содержат NULL и заполняются только когда
соответствующая статистика вычисляется командой ANALYZE.
52.52. pg_subscription
В каталоге pg_subscription содержатся все существующие подписки логической репликации. По-
дробнее логическая репликация описана в Главе 31.
В отличие от большинства системных каталогов, pg_subscription разделяется всеми базами дан-
ных кластера: есть только один экземпляр pg_subscription в кластере, а не отдельные в каждой
базе данных.
Обычные пользователи не имеют доступа к столбцу subconninfo, так как он может содержать
пароль в открытом виде.
Таблица 52.52. Столбцы pg_subscription
Имя Тип
Ссылки
Описание
oid oid subdbid oid subname name subowner oid subenabled bool Если true, подписка
включена и должна
реплицироваться.
subsynccommit text Содержит значение па-
раметра synchronous_
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pg_database .oid
OID базы данных, в
которой располагается
эта подписка
Имя подписки
pg_authid .oid
1981
Владелец подпискиСистемные каталоги
Имя Тип
Ссылки
Описание
commit
для рабочих
процессов подписки.
subconninfo text Строка подключения к
вышестоящей базе дан-
ных
subslotname name Имя слота репликации
в вышестоящей базе
данных. Также приме-
няется в качестве ло-
кального имени источ-
ника репликации.
subpublications text[] Массив имён публика-
ций, на которые оформ-
лена подписка. Под-
писки с этими имена-
ми должны быть опуб-
ликованы на сервере.
Подробнее публикации
описаны в Разделе 31.1.
52.53. pg_subscription_rel
Каталог pg_subscription_rel содержит состояние каждого реплицируемого отношения в каждой
подписке (это связь вида многие-ко-многим).
Этот каталог содержит только таблицы, известные в подписке после выполнения CREATE
SUBSCRIPTION или ALTER SUBSCRIPTION ... REFRESH PUBLICATION.
Таблица 52.53. Столбцы pg_subscription_rel
Имя Тип Ссылки Описание
srsubid oid pg_subscription .oid Ссылка на подписку
srrelid oid pg_class .oid Ссылка на отношение
srsubstate char Код состояния: i = ини-
циализация, d = копи-
рование данных, s =
синхронизация выпол-
нена, r = готовность (
обычная репликация)
srsublsn pg_lsn Конечный LSN для со-
стояний s и r.
52.54. pg_tablespace
В каталоге pg_tablespace хранится информация о доступных табличных пространствах. Таблицы
могут быть распределены по разным табличным пространствам для эффективного использования
дискового хранилища.
В отличие от большинства системных каталогов, pg_tablespace разделяется всеми базами данных
кластера: есть только один экземпляр pg_tablespace в кластере, а не отдельные для каждой базы
данных.
1982Системные каталоги
Таблица 52.54. Столбцы pg_tablespace
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
spcname name Имя табличного
странства
spcowner oid spcacl aclitem[] Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
spcoptions text[] Параметры уровня таб-
личного пространства,
в виде строк «клю-
ч=значение»
pg_authid .oid
Описание
про-
Владелец
табличного
пространства, обычно
пользователь, создав-
ший его
52.55. pg_transform
В каталоге pg_transform хранятся сведения о трансформациях, которые представляют собой ме-
ханизм адаптирования типов данных для процедурных языков. За дополнительной информацией
обратитесь к CREATE TRANSFORM.
Таблица 52.55. Столбцы pg_transform
Имя Тип Ссылки Описание
trftype oid pg_type .oid OID типа данных, для
которого предназначе-
на трансформация
trflang oid pg_language .oid OID языка, для ко-
торого предназначена
трансформация
trffromsql regproc pg_proc .oid OID функции, вызыва-
емой для преобразова-
ния типа данных, по-
даваемого на вход про-
цедурному языку (на-
пример, в параметрах
функции). Ноль, если
эта операция не под-
держивается.
trftosql regproc pg_proc .oid OID функции, вызыва-
емой для преобразова-
ния значения, выдавае-
мого процедурным язы-
ком, (например, возвра-
щаемых значений) к ти-
пу данных. Ноль, если
эта операция не под-
держивается.
1983Системные каталоги
52.56. pg_trigger
В каталоге pg_trigger хранятся триггеры для таблиц и представлений. За дополнительными све-
дениями обратитесь к описанию CREATE TRIGGER.
Таблица 52.56. Столбцы pg_trigger
Имя Тип
Ссылки
Описание
oid oid tgrelid oid tgname name tgfoid oid tgtype int2 Битовая маска, задаю-
щая условия срабаты-
вания триггера
tgenabled char Устанавливает, в ка-
ких режимах session_
replication_role сраба-
тывает триггер: O =
триггер срабатывает в
режимах «origin» (ис-
точник) и «local» (ло-
кально), D = триггер
отключён, R = триггер
срабатывает в режиме
«replica» (реплика), A
= триггер срабатывает
всегда.
tgisinternal bool True,
если
триггер
создан
внутри
си-
стемы (обычно, для
реализации ограниче-
ния,
заданного
в
tgconstraint)
tgconstrrelid oid pg_class .oid Таблица, задействован-
ная в ограничении ссы-
лочной целостности
tgconstrindid oid pg_class .oid Индекс, поддерживаю-
щий ограничение уни-
кальности, первичного
ключа или ссылочной
целостности, либо огра-
ничение-исключение
tgconstraint oid pg_constraint .oid Запись
в
pg_
constraint , связанная
этим триггером, если
такая имеется
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
pg_class .oid
Таблица, к которой от-
носится этот триггер
Имя триггера (должно
быть уникальным среди
триггеров одной табли-
цы)
pg_proc .oid
1984
Вызываемая функцияСистемные каталоги
Имя Тип
Ссылки
tgdeferrable bool True, если триггер огра-
ничения является от-
кладываемым
tginitdeferred bool True, если триггер огра-
ничения изначально от-
ложенный
tgnargs int2 Число аргументов, пе-
редаваемых
функции
триггера
tgattr int2vector tgargs bytea Аргументы
строково-
го типа, передаваемые
триггеру, с NULL в кон-
це каждого
tgqual pg_node_tree Дерево выражения (в
представлении
nodeToString() ) для
условия триггера WHEN,
либо NULL, если оно от-
сутствует
tgoldtable name Предложение
REFERENCING для OLD
TABLE или NULL в слу-
чае его отсутствия
tgnewtable name Предложение
REFERENCING для NEW
TABLE или NULL в слу-
чае его отсутствия
pg_attribute .attnum
Описание
Номера столбцов, ес-
ли триггер привязан к
столбцам; в противном
случае пустой массив
В настоящее время триггеры, привязанные к столбцам, поддерживаются только для событий
UPDATE, так что tgattr применимо только к событиям такого типа. Поле tgtype может содержать
биты и для других типов событий, но они распространяются только на таблицы, вне зависимости
от значения tgattr.
Примечание
Когда tgconstraint содержит не ноль, то есть ссылается на запись в pg_constraint, по-
ля tgconstrrelid, tgconstrindid, tgdeferrable и tginitdeferred по большому счёту
избыточны, они повторяют значения в этой записи. Однако, возможно связать неоткла-
дываемый триггер с откладываемым ограничением: с ограничениями внешнего ключа
могут быть связаны и откладываемые, и неоткладываемые триггеры.
Примечание
Если для отношения есть какие-либо триггеры в этом каталоге, значением
pg_class.relhastriggers для неё должно быть true.
52.57. pg_ts_config
1985Системные каталоги
Каталог pg_ts_config содержит записи, представляющие конфигурации текстового поиска. Кон-
фигурация задаёт определённый анализатор текстового поиска и список словарей, которые будут
использоваться для каждого из фрагментов, выдаваемых анализатором. Анализатор задаётся в за-
писи в pg_ts_config, а сопоставления фрагментов со словарями определяются в подчинённых за-
писях в pg_ts_config_map.
Возможности текстового поиска PostgreSQL углублённо рассматриваются в Главе 12.
Таблица 52.57. Столбцы pg_ts_config
Имя Тип
Ссылки
Описание
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
cfgname name Имя конфигурации тек-
стового поиска
cfgnamespace oid pg_namespace .oid OID
пространства
имён, содержащего эту
конфигурацию
cfgowner oid pg_authid .oid Владелец
ции
cfgparser oid pg_ts_parser OID анализатора тек-
стового поиска для этой
конфигурации
.oid
конфигура-
52.58. pg_ts_config_map
В каталоге pg_ts_config_map содержатся записи, показывающие, к каким словарям текстового
поиска и в каком порядке следует обращаться для каждого типа фрагмента, выдаваемого каждым
анализатором текстового поиска.
Возможности текстового поиска PostgreSQL углублённо рассматриваются в Главе 12.
Таблица 52.58. Столбцы pg_ts_config_map
Имя Тип Ссылки mapcfg oid pg_ts_config maptokentype integer Тип фрагмента, выда-
ваемый анализатором
текстового поиска
mapseqno integer Порядок, в котором
нужно просматривать
эту запись (меньшие
mapseqno просматрива-
ются сначала)
mapdict oid
pg_ts_dict
Описание
.oid
.oid
OID записи в pg_ts_
config , к которой от-
носится эта запись со-
поставления
OID словаря текстово-
го поиска, к которому
нужно обратиться
52.59. pg_ts_dict
В каталоге pg_ts_dict содержатся записи, определяющие словари текстового поиска. Словарь
зависит от шаблона текстового поиска, в котором задаются все требуемые функции реализации;
сам словарь предоставляет значения для настраиваемых параметров, поддерживаемых шаблонов.
1986Системные каталоги
Такое разделение позволяет создавать словари непривилегированным пользователям. Параметры
задаются текстовой строкой dictinitoption, их формат и значение зависят от шаблона.
Возможности текстового поиска PostgreSQL углублённо рассматриваются в Главе 12.
Таблица 52.59. Столбцы pg_ts_dict
Имя Тип
Ссылки
Описание
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
dictname name Имя словаря текстово-
го поиска
dictnamespace oid pg_namespace .oid OID
пространства
имён,
содержащего
этот словарь
dictowner oid pg_authid .oid Владелец словаря
dicttemplate oid pg_ts_template dictinitoption text
.oid
OID шаблона текстово-
го поиска для этого сло-
варя
Строка с параметра-
ми инициализации для
шаблона
52.60. pg_ts_parser
В каталоге pg_ts_parser содержатся записи, определяющие анализаторы текстового поиска. Ана-
лизатор отвечает за разделение входного текста на лексемы и назначение типа фрагмента каждой
лексеме. Так как анализатор должен быть реализован в функции на языке уровня C, создавать
новые анализаторы разрешено только суперпользователям баз данных.
Возможности текстового поиска PostgreSQL углублённо рассматриваются в Главе 12.
Таблица 52.60. Столбцы pg_ts_parser
Имя Тип
Ссылки
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
prsname name Имя анализатора тек-
стового поиска
prsnamespace oid pg_namespace .oid OID
пространства
имён,
содержащего
этот анализатор
prsstart regproc pg_proc .oid OID функции запуска
анализатора
prstoken regproc pg_proc .oid OID функции анализа-
тора, выдающей следу-
ющий фрагмент
prsend regproc pg_proc .oid OID функции анали-
затора, оканчивающей
разбор
prsheadline regproc pg_proc .oid OID функции анали-
затора, выдающей вы-
держки
1987
ОписаниеСистемные каталоги
Имя Тип Ссылки Описание
prslextype regproc pg_proc .oid OID функции анализа-
тора лексических типов
52.61. pg_ts_template
В каталоге pg_ts_template содержатся записи, определяющие шаблоны текстового поиска. Шаб-
лон представляет собой заготовку для класса словарей текстового поиска. Так как шаблон должен
быть реализован в функциях на уровне языка C, создавать новые шаблоны разрешено только су-
перпользователям базы.
Возможности текстового поиска PostgreSQL углублённо рассматриваются в Главе 12.
Таблица 52.61. Столбцы pg_ts_template
Имя Тип
Ссылки
Описание
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
tmplname name Имя шаблона текстово-
го поиска
tmplnamespace oid pg_namespace .oid OID
пространства
имён,
содержащего
этот шаблон
tmplinit regproc pg_proc .oid OID функции инициали-
зации шаблона
tmpllexize regproc pg_proc .oid OID функции выделе-
ния лексем
52.62. pg_type
В каталоге pg_type хранится информация о типах данных. Базовые типы и типы-перечисления
(скалярные типы) создаются командой CREATE TYPE, а домены — командой CREATE DOMAIN. При
добавлении любой таблицы в базу данных автоматически создаётся составной тип, представляю-
щий структуру строки таблицы. Также возможно создавать составные типы с помощью команды
CREATE TYPE AS.
Таблица 52.62. Столбцы pg_type
Имя Тип
Ссылки
Описание
oid oid Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
typname name Имя типа данных
typnamespace oid pg_namespace .oid OID
пространства
имён,
содержащего
этот тип
typowner oid pg_authid .oid Владелец типа
typlen int2
Для типа фиксирован-
ного размера в typlen
задаётся число байт
во внутреннем пред-
ставлении типа. Но
для типов переменной
длины, typlen будет
1988Системные каталоги
Имя Тип
Ссылки
typbyval bool Поле typbyval опреде-
ляет, будут ли внутрен-
ние процедуры переда-
вать переменные это-
го типа по значению
или по ссылке. Полю
typbyval лучше при-
своить false, если дли-
на typlen не равна 1, 2
или 4 (либо 8, на 64-бит-
ных машинах). Типы пе-
ременной длины всегда
передаются по ссылке.
Заметьте, что typbyval
может быть false, даже
если размер типа поз-
воляет передачу по зна-
чению.
typtype char Поле typtype прини-
мает значение b для
базового типа (base),
c для составного (
composite), то есть ти-
па строки таблицы, d
для домена (domain),
e для перечисления (
enum), p для псевдоти-
па (pseudo-type) или r
для диапазона (range).
См. также typrelid и
typbasetype.
typcategory char В поле typcategory
задаётся произвольная
классификация типов
данных, на основе кото-
рой анализатор запро-
сов может определить,
какие неявные приве-
дения будут «предпочи-
таемыми». См. Табли-
цу 52.63.
typispreferred bool True, если этот тип
является предпочитае-
мым целевым типом
в своей категории (
typcategory)
1989
Описание
отрицательным. Значе-
ние -1 обозначает тип
«varlena» (он содержит
машинное слово, опре-
деляющее длину), а -2
обозначает строку в
стиле C, оканчивающу-
юся нулём.Системные каталоги
Имя Тип
Ссылки
typisdefined bool True, если тип опре-
делён, и false, если
это тип-заготовка для
ещё не определённого
типа. Когда значение
typisdefined — false,
можно полагаться толь-
ко на заданное имя,
пространство имён и
OID типа.
typdelim char Символ, разделяющий
два значения этого ти-
па при разборе вводи-
мого массива. Заметь-
те, что этот раздели-
тель связывается с ти-
пом данных элемента
массива, а не с типом
самого массива.
typrelid oid pg_class .oid Если это составной тип
(см. typtype), этот стол-
бец указывает на за-
пись pg_class , опре-
деляющую соответству-
ющую таблицу. (Для
независимого составно-
го типа запись в pg_
class
на самом де-
ле не представляет таб-
лицу, но она всё рав-
но нужна для связы-
вания с записями pg_
attribute этого типа.)
Для не составных типов
содержит ноль.
typelem oid pg_type .oid Если значение typelem
не 0, оно указывает на
другую строку в pg_
type . В этом случае
к текущему типу мож-
но обращаться по ин-
дексу, как к масси-
ву, и получать значе-
ния типа typelem. «На-
стоящий» тип массива
имеет переменную дли-
ну (typlen = -1), но
для некоторых типов
фиксированной длины (
typlen &gt; 0) также опре-
деляется typelem, на-
пример, для name и
point. Если для ти-
па фиксированной дли-
1990
ОписаниеСистемные каталоги
Имя Тип Ссылки Описание
ны определён typelem,
его внутренним пред-
ставлением будет неко-
торое количество зна-
чений типа typelem,
без других данных. Ти-
пы массивов перемен-
ной длины также содер-
жат заголовок, опреде-
ляемый подпрограмма-
ми массива.
typarray oid pg_type .oid Если поле typarray не
равно 0, оно указыва-
ет на другую запись
в pg_type , описываю-
щую «настоящий» тип
массива, в которой этот
тип будет элементом
typinput regproc pg_proc .oid Функция преобразова-
ния ввода (из текстово-
го формата)
typoutput regproc pg_proc .oid Функция преобразова-
ния вывода (в тексто-
вый формат)
typreceive regproc pg_proc .oid Функция преобразова-
ния ввода (из двоично-
го формата), либо 0, ес-
ли её нет
typsend regproc pg_proc .oid Функция преобразова-
ния вывода (в двоичный
формат), либо 0, если её
нет
typmodin regproc pg_proc .oid Функция ввода модифи-
катора типа, либо 0, ес-
ли тип не поддержива-
ет модификаторы
typmodout regproc pg_proc .oid Функция вывода моди-
фикатора типа, либо
0 для использования
стандартного формата
typanalyze regproc pg_proc .oid Нестандартная
функ-
ция
ANALYZE,
либо
0 для использования
стандартной функции
typalign char
Переменная typalign
определяет выравнива-
ние, требуемое при хра-
нении значения это-
го типа. Эта величи-
на применяется при
хранении на диске, а
также для большинства
представлений значе-
1991Системные каталоги
Имя
Тип
Ссылки
Описание
ний внутри PostgreSQL.
Когда последователь-
но хранятся несколь-
ко значений, как на-
пример в представле-
нии полной строки на
диске, дополнительные
байты добавляются пе-
ред значением этого ти-
па, чтобы оно начина-
лось с указанной грани-
цы. Заданное выравни-
вание определяет сме-
щение первого элемен-
та последовательности.
Возможные значения:
• c = выравнивание
по символам (char),
то есть выравнива-
ние не требуется.
• s = выравнивание
по коротким сло-
вам (short), 2 байта
для большинства ма-
шин.
• i = выравнивание
по целым (int), 4
байта для большин-
ства машин.
• d = выравнивание
по двойным словам
(double), 8 байт для
большинства ма-
шин, но не для всех.
Примечание
Для
ти-
пов, исполь-
зуемых в си-
стемных
таблицах,
важно, что-
бы размер
и выравни-
вание, опре-
делённые в
pg_
type ,
со-
гласовыва-
лись с тем,
как компи-
лятор рас-
1992Системные каталоги
Имя Тип
typstorage char
Ссылки
Описание
полагает
этот стол-
бец в струк-
туре, пред-
ставляю-
щей строку
таблицы.
Значение
typstorage
для типов varlena (ти-
пов с typlen = -1) го-
ворит, готов ли тип для
помещения в TOAST,
и какова стратегия по
умолчанию для атрибу-
тов этого типа. Возмож-
ные значения:
• p: Значение всегда
должно храниться
простым образом (
plain).
• e: Значение мо-
жет храниться во
«вторичном» от-
ношении (если
оно есть, см. pg_
class.reltoastrelid ).
• m: Значение может
храниться сжатым
внутри строки.
• x: Значение может
храниться сжатым
внутри строки или
во «вторичном» хра-
нилище.
Заметьте, что столбцы m
тоже могут быть пере-
мещены во вторичное
хранилище, но только в
качестве последней ме-
ры (столбцы e и x пе-
ремещаются в первую
очередь).
typnotnull bool
typbasetype oid
Поле typnotnull пред-
ставляет ограничение
«не NULL» для ти-
па. Применяется толь-
ко для доменов.
pg_type .oid
1993
Если
это
домен
(
см.
typtype),
то
typbasetype указывает
на тип, на котором онСистемные каталоги
Имя Тип
Ссылки
typtypmod int4 Домены
используют
typtypmod для записи
модификатора (typmod),
применяемого к их ба-
зовому типу (-1, если
базовый тип не исполь-
зует typmod). Если тип
не является доменом,
принимает значение -1.
typndims int4 Значение typndims за-
даёт число размерно-
стей массива для доме-
на, определённого по-
верх массива (то есть,
когда typbasetype —
тип массива). Для ти-
пов, отличных от доме-
нов поверх типов масси-
вов, принимает значе-
ние 0.
typcollation oid typdefaultbin pg_node_tree Если
поле
typdefaultbin
не
NULL, в нём содержит-
ся представление вы-
ражения по умолчанию
для этого типа (совме-
стимое с nodeToString(
) . Это поле использу-
ется только для доме-
нов.
typdefault text Поле typdefault содер-
жит NULL, если с ти-
пом не связано зна-
чение по умолчанию.
Если
typdefaultbin
pg_collation .oid
1994
Описание
основан. Ноль, если это
не домен.
Значение typcollation
задаёт правило сорти-
ровки для типа. Ес-
ли тип не поддержи-
вает сортировки, оно
должно
быть
нуле-
вым. У базового ти-
па, поддерживающего
сортировки,
в
этом
поле будет DEFAULT_
COLLATION_OID .
До-
мен на базе сорти-
руемого типа может
иметь другой OID пра-
вила сортировки, если
оно было изменено для
домена.Системные каталоги
Имя Тип
typacl aclitem[]
Ссылки
Описание
не NULL, typdefault
должно содержать по-
нятную человеку вер-
сию выражения зна-
чения
по
умол-
чанию,
записанного
в typdefaultbin. Ес-
ли typdefaultbin со-
держит
NULL,
а
typdefault
нет,
то
в typdefault находит-
ся внешнее представле-
ние значения по умол-
чанию, которое можно
передать функции пре-
образования ввода и по-
лучить константу.
Права доступа; за по-
дробностями
обрати-
тесь к описанию GRANT
и REVOKE
В Таблице 52.63 перечисляются определённые в системе значения typcategory. Если этот список
будет дополняться в будущем, в него будут добавляться тоже буквы ASCII в верхнем регистре. Все
другие символы ASCII зарезервированы для категорий, определяемых пользователями.
Таблица 52.63. Коды typcategory
Код Категория
A Типы массивов
B Логические типы
C Составные типы
D Типы даты/времени
E Типы-перечисления
G Геометрические типы
I Типы, описывающие сетевые адреса
N Числовые типы
P Псевдотипы
R Диапазонные типы
S Строковые типы
T Интервальные типы
U Пользовательские типы
V Типы битовых строк
X Неизвестный тип (unknown)
52.63. pg_user_mapping
В каталоге pg_user_mapping хранятся сопоставления локальных пользователей с удалёнными.
Обычные пользователи не имеют доступа к этому каталогу, они должны использовать представле-
ние pg_user_mappings.
1995Системные каталоги
Таблица 52.64. Столбцы pg_user_mapping
Имя Тип
Ссылки
Описание
oid oid umuser oid pg_authid .oid OID сопоставляемой ло-
кальной роли, либо 0,
если сопоставление за-
даётся для всех
umserver oid pg_foreign_
server .oid OID стороннего серве-
ра, содержащего это со-
поставление
umoptions text[]
Идентификатор строки
(скрытый атрибут; дол-
жен выбираться явно)
Специальные парамет-
ры сопоставления поль-
зователей, в виде строк
«ключ=значение»
52.64. Системные представления
В дополнение к системным каталогам, в PostgreSQL есть набор встроенных представлений. Неко-
торые системные представления содержат в себе некоторые популярные запросы к системным
каталогам, а другие дают доступ к внутреннему состоянию сервера.
Информационная схема (см. Главу 37) содержит другой набор представлений, пересекающихся по
функциональности с системными представлениям. Так как информационная схема соответствует
стандарту SQL, тогда как описанные здесь представления свойственны только для PostgreSQL,
обычно лучше использовать информационную схему, если через неё можно получить всю требуе-
мую информацию.
В Таблице 52.65 кратко перечислены описываемые здесь системные представления. Более подроб-
ное описание каждого представления следует далее. Есть также дополнительные представления,
дающие доступ к результатам работы сборщика статистики; они перечисляются в Таблице 28.2.
Кроме явно отмеченных исключений, все описанные здесь представления доступны только для
чтения.
Таблица 52.65. Системные представления
Имя представления Предназначение
pg_available_extensions доступные расширения
pg_available_extension_versions доступные версии расширений
pg_config параметры конфигурации времени компиляции
pg_cursors открытые курсоры
pg_file_settings сводка содержимого файла конфигурации
pg_group группы пользователей баз данных
pg_hba_file_rules сводка содержимого файла
аутентификации клиентов
pg_indexes индексы
pg_locks блокировки, установленные или ожидаемые в
данный момент
pg_matviews материализованные представления
pg_policies policies
pg_prepared_statements подготовленные операторы
1996
конфигурацииСистемные каталоги
Имя представления Предназначение
pg_prepared_xacts подготовленные транзакции
pg_publication_tables публикации и связанные с ними таблицы
pg_replication_origin_status информация об источниках репликации, вклю-
чая данные прогресса репликации
pg_replication_slots информация о слотах репликации
pg_roles роли баз данных
pg_rules правила
pg_seclabels метки безопасности
pg_sequences последовательности
pg_settings значения параметров
pg_shadow пользователи базы данных
pg_stats статистика планировщика
pg_tables таблицы
pg_timezone_abbrevs аббревиатуры часовых поясов
pg_timezone_names имена часовых поясов
pg_user пользователи базы данных
pg_user_mappings сопоставления пользователей
pg_views представления
52.65. pg_available_extensions
В представлении pg_available_extensions перечисляются расширения, доступные для установ-
ки. Также обратите внимание на каталог pg_extension, в котором перечисляются уже установлен-
ные расширения.
Таблица 52.66. Столбцы pg_available_extensions
Имя Тип Описание
name name Имя расширения
default_version text Имя версии по умолчанию, либо
NULL, если это имя не определе-
но
installed_version text Текущая установленная версия
расширения, либо NULL, если
расширение не установлено
comment text Строка комментария из управ-
ляющего файла расширения
Представление pg_available_extensions доступно только для чтения.
52.66. pg_available_extension_versions
В представлении pg_available_extension_versions перечислены определённые версии расшире-
ний, доступные для установки. Также обратите внимание на каталог pg_extension, в котором пе-
речисляются уже установленные расширения.
Таблица 52.67. Столбцы pg_available_extension_versions
Имя Тип Описание
name name Имя расширения
1997Системные каталоги
Имя Тип Описание
version text Имя версии
installed bool True, если эта версия расшире-
ния уже установлена
superuser bool True, если устанавливать это
расширение разрешено только
суперпользователям
relocatable bool True, если расширение можно
переместить в другую схему
schema name Имя схемы, в которую должно
быть установлено расширение,
либо NULL, если оно частично
или полностью переместимо
requires name[] Имена расширений, требую-
щихся для данного, либо NULL,
если таких нет
comment text Строка комментария из управ-
ляющего файла расширения
Представление pg_available_extension_versions доступно только для чтения.
52.67. pg_config
В представлении pg_config описываются конфигурационные параметры времени компиляции
для текущей установленной версии PostgreSQL. Оно предназначено, например, для программ-
ных средств, которым может потребоваться узнать у PostgreSQL расположение требуемых заголо-
вочных файлов и библиотек. Оно выдаёт ту же базовую информацию, что и клиентская утилита
PostgreSQL pg_config.
По умолчанию представление pg_config доступно только суперпользователям и только для чте-
ния.
Таблица 52.68. Столбцы pg_config
Имя Тип Описание
name text Имя параметра
setting text Значение параметра
52.68. pg_cursors
В представлении pg_cursors перечисляются курсоры, доступные в данный момент. Курсоры могут
быть созданы несколькими способами:
• через оператор DECLARE в SQL
• через сообщение Bind в клиент-серверном протоколе, как описано в Подразделе 53.2.3
• через интерфейс программирования сервера (SPI, Server Programming Interface), как описано
в Разделе 47.1
В представлении pg_cursors показываются курсоры, полученные любым способом. Курсор суще-
ствует только на протяжении транзакции, в которой он определён, если только он не был объявлен
с указанием WITH HOLD. Поэтому не удерживаемые курсоры показываются в этом представлении
только пока не завершится создавшая их транзакция.
1998Системные каталоги
Примечание
Курсоры используются внутри системы для реализации некоторых компонен-
тов PostgreSQL, таких как процедурные языки. Таким образом, в представлении
pg_cursors могут быть курсоры, которые пользователи не создавали явно.
Таблица 52.69. Столбцы pg_cursors
Имя Тип Описание
name text Имя курсора
statement text Дословная строка запроса, со-
здавшего данный курсор
is_holdable boolean True, если курсор удерживае-
мый (то есть, к нему можно об-
ращаться после того, как бу-
дет зафиксирована транзакция,
в которой он объявлен); в про-
тивном случае — false
is_binary boolean True, если курсор был объявлен
с указанием BINARY; в против-
ном случае — false
is_scrollable boolean True, если курсор прокручива-
емый (то есть, позволяет по-
лучать строки непоследователь-
ным образом); в противном слу-
чае — false
creation_time timestamptz Время, в которое был объявлен
курсор
Представление pg_cursors доступно только для чтения.
52.69. pg_file_settings
В представлении pg_file_settings показывается сводное содержимое файлов конфигурации сер-
вера. Для каждой имеющейся в этих файлах записи «имя = значение» это представление содержит
строку с отметкой, показывающей, может ли это значение быть успешно применено. Также это
представление может содержать дополнительные строки, говорящие о проблемах, не связанных с
записями «имя = значение», например, синтаксических ошибках в этих файлах.
Это представление полезно для проверки, будут ли работать планируемые изменения в файлах
конфигурации, или для диагностики возникшей ранее проблемы. Заметьте, что в этом представле-
нии отражается текущее содержимое файлов, а не то, что было применено сервером в последний
раз. (Чтобы получить то состояние, обычно достаточно обратиться к представлению pg_settings.)
По умолчанию представление pg_file_settings доступно только суперпользователям и только
для чтения.
Таблица 52.70. Столбцы pg_file_settings
Имя Тип Описание
sourcefile text Полный путь и имя файла кон-
фигурации
sourceline integer Номер строки в файле конфигу-
рации, из которой получена эта
запись
1999Системные каталоги
Имя Тип Описание
seqno integer Порядок, в котором обрабатыва-
ются записи (1..n)
name text Имя параметра конфигурации
setting text Значение, присваиваемое пара-
метру
applied boolean True, если значение может быть
применено успешно
error text Сообщение об ошибке, гово-
рящее, почему эта запись не
может быть применена, либо
NULL
Если файл конфигурации содержит синтаксические ошибки или недопустимые имена парамет-
ров, сервер не будет пытаться применять никакие параметры из него, так что все поля applied
будут равны False. В этом случае представление будет содержать одну или несколько строк, в ко-
торых поле error описывает проблему. Иначе отдельные записи этого файла будут применяться
по возможности. Если заданное в некоторой записи присвоение выполнить нельзя (например, из-
за неверного значения или если параметр нельзя изменять после запуска сервера), в поле error
для неё будет записано соответствующее сообщение. Поле applied также может содержать False,
если данная запись переопределяется последующей записью с тем же именем параметра; это не
считается ошибкой, так что поле error будет пустым.
Чтобы узнать больше о различных способах изменения параметров времени выполнения, обрати-
тесь к Разделу 19.1.
52.70. pg_group
Представление pg_group существует для обратной совместимости: оно эмулирует каталог, суще-
ствовавший в PostgreSQL до версии 8.1. В нём показываются имена и члены всех ролей без при-
знака rolcanlogin, что приблизительно соответствует списку ролей, которые использовались как
группы.
Таблица 52.71. Столбцы pg_group
Имя Тип Ссылки Описание
groname name pg_authid .rolname Имя группы
grosysid oid pg_authid .oid ID этой группы
grolist oid[] pg_authid .oid Массив,
содержащий
идентификаторы ролей
в этой группе
52.71. pg_hba_file_rules
В представлении pg_hba_file_rules показывается сводное содержимое файла конфигурации
аутентификации клиентов, pg_hba.conf. Для каждой непустой и незакомментированной строки в
этом файле данное представление содержит одну строку, с отметкой, показывающей, может ли
это правило быть успешно применено.
Это представление может быть полезно для проверки, будут ли работать планируемые изменения
в файле конфигурации аутентификации, или для диагностики возникшей проблемы. Заметьте, что
в этом представлении отражается текущее содержимое файла, а не то, что было загружено сер-
вером в последний раз.
По умолчанию представление pg_hba_file_rules доступно только суперпользователям и только
для чтения.
2000Системные каталоги
Таблица 52.72. Столбцы pg_hba_file_rules
Имя Тип Описание
line_number integer Номер строки этого правила в
pg_hba.conf
type text Тип подключения
database text[] Список имён баз данных, к кото-
рым применяется это правило
user_name text[] Список имён пользователей и
групп, к которым применяется
это правило
address text Имя или IP-адрес узла либо одно
из значений: all, samehost или
samenet, либо NULL для локаль-
ных подключений
netmask text Маска IP-адреса либо NULL, ес-
ли это неприменимо
auth_method text Метод аутентификации
options text[] Параметры, задаваемые для ме-
тода аутентификации (если они
есть)
error text Сообщение об ошибке, гово-
рящее, почему эта строка не
может быть обработана, либо
NULL
Обычно строка, отражающая некорректную запись, будет содержать значения только в полях
line_number и error.
Чтобы узнать больше о конфигурации аутентификации клиентов, обратитесь к Главе 20.
52.72. pg_indexes
Представление pg_indexes даёт доступ к полезной информации обо всех индексах в базе данных.
Таблица 52.73. Столбцы pg_indexes
Имя Тип Ссылки
Описание
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей таблицу и индекс
tablename name pg_class .relname
Имя таблицы, для кото-
рой создан индекс
indexname name pg_class .relname
Имя индекса
tablespace name pg_
tablespace .spcname
Имя табличного про-
странства, содержаще-
го индекс (NULL, ес-
ли это пространство по
умолчанию)
indexdef text
Определение
индек-
са
(реконструирован-
ная команда CREATE
INDEX)
52.73. pg_locks
2001Системные каталоги
Представление pg_locks даёт доступ к информации о блокировках, удерживаемых активными про-
цессами на сервере баз данных. Подробнее блокировки рассматриваются в Главе 13.
Представление pg_locks содержит одну строку для каждого активного блокируемого объекта, за-
прошенного режима блокировки и блокирующего процесса. Таким образом, один и тот же бло-
кируемый объект может фигурировать в этом представлении неоднократно, если его блокируют
или ожидают блокировки несколько процессов. Однако объекты, свободные от блокировок, в этом
представлении отсутствуют вовсе.
Существует несколько различных типов блокируемых объектов: отношения целиком (например,
таблицы), отдельные страницы отношений, отдельные кортежи отношений, идентификаторы тран-
закций (виртуальные и постоянные) и произвольные объекты баз данных (идентифицируемые по
OID класса и OID объекта, так же как в pg_description или pg_depend). Кроме того, в виде отдель-
ного блокируемого объекта представлено право расширения отношения. Также могут быть уста-
новлены «рекомендательные» блокировки, не имеющие предопределённого значения.
Таблица 52.74. Столбцы pg_locks
Имя Тип
Ссылки
Описание
locktype text database oid pg_database .oid OID базы данных, к ко-
торой относится цель
блокировки, ноль, если
это разделяемый объ-
ект, либо NULL, если
целью является иденти-
фикатор транзакции
relation oid pg_class .oid OID отношения, явля-
ющегося целью блоки-
ровки, либо NULL, ес-
ли цель блокировки —
не отношение или часть
отношения
page integer Номер страницы в отно-
шении, являющейся це-
лью блокировки, либо
NULL, если цель бло-
кировки — не страница
или кортеж отношения
tuple smallint Номер кортежа на стра-
нице, являющегося це-
лью блокировки, либо
NULL, если цель блоки-
ровки — не кортеж
Тип блокируемого объ-
екта: relation (отноше-
ние), extend (расшире-
ние отношения), page (
страница), tuple (кор-
теж), transactionid (
идентификатор
тран-
закции), virtualxid (
виртуальный
иденти-
фикатор), object (объ-
ект), userlock (поль-
зовательская блокиров-
ка) или advisory (реко-
мендательная)
2002Системные каталоги
Имя Тип
Ссылки
virtualxid text Виртуальный
иден-
тификатор
транзак-
ции, являющийся це-
лью блокировки, либо
NULL, если цель блоки-
ровки — другой объект
transactionid xid Идентификатор тран-
закции,
являющийся
целью блокировки, ли-
бо NULL, если цель бло-
кировки — другой объ-
ект
classid oid pg_class .oid OID системного ка-
талога,
содержащего
цель блокировки, либо
NULL, если цель бло-
кировки — не обычный
объект базы данных
objid oid любой столбец OID OID цели блокировки
в соответствующем си-
стемном каталоге, ли-
бо NULL, если цель бло-
кировки — не обычный
объект базы данных
objsubid smallint Номер столбца, явля-
ющегося целью блоки-
ровки (на саму табли-
цу указывают classid
и objid), ноль, если
это некоторый другой
обычный объект базы
данных, либо NULL, ес-
ли цель не обычный
объект
virtualtransaction text Виртуальный иденти-
фикатор
транзакции,
удерживающей
или
ожидающей блокиров-
ку
pid integer Идентификатор сервер-
ного процесса (PID,
Process ID), удержива-
ющего или ожидающе-
го эту блокировку, либо
NULL, если блокиров-
ка удерживается подго-
товленной транзакцией
mode text Название режима бло-
кировки, которая удер-
живается или запраши-
вается этим процессом
(см. Подраздел 13.3.1 и
Подраздел 13.2.3)
2003
ОписаниеСистемные каталоги
Имя Тип
Ссылки
Описание
granted boolean True, если блокировка
получена, и false, если
она ожидается
fastpath boolean True, если блокировка
получена по короткому
пути, и false, если она
получена через основ-
ную таблицу блокиро-
вок
Признак granted устанавливается в строке, представляющей блокировку, удерживаемую указан-
ным процессом. Если он сброшен, этот процесс ждёт блокировки, из чего следует что как мини-
мум один другой процесс удерживает или ожидает блокировку того же объекта в конфликтующем
режиме. Ожидающий процесс будет приостановлен до освобождения другой блокировки (или вы-
явления ситуации взаимоблокировки). Один процесс в один момент времени может ожидать полу-
чения максимум одной блокировки.
На протяжении транзакции серверный процесс удерживает исключительную блокировку вирту-
ального идентификатора транзакции. Если транзакции назначается постоянный идентификатор
(что обычно происходит, только если транзакция изменяет состояние базы данных), он также удер-
живает до её завершения блокировку этого постоянного идентификатора. Когда процесс находит
необходимым ожидать именно какую-то другую транзакцию, он делает это, запрашивая разделя-
емую блокировку для идентификатора этой транзакции (виртуального или постоянного, в зависи-
мости от ситуации). Этот запрос будет выполнен, только когда другая транзакция завершится и
освободит свои блокировки.
Хотя кортежи тоже представляют собой блокируемый объект, информация о блокировках строк
хранится на диске, а не в памяти, поэтому такие блокировки обычно не показываются в этом пред-
ставлении. Если процесс ожидает блокировки на уровне строки, он обычно виден в нём как ожи-
дающий постоянного идентификатора транзакции текущего владельца этой блокировки.
Рекомендательные блокировки могут быть получены по ключам, состоящим из одного значения
bigint или из двух значений integer. Старшая половина bigint выводится в столбце classid, а
младшая половина в столбце objid, и objsubid равен 1. Исходное значение bigint может быть
восстановлено выражением (classid::bigint &lt;&lt; 32) | objid::bigint. Для ключей integer пер-
вая часть ключа находится в classid, а вторая часть в objid, и objsubid равна 2. Конкретное пред-
назначение этих ключей определяет пользователь. Рекомендательные блокировки существуют в
рамках базы данных, поэтому столбец database имеет значение для таких блокировок.
Представление pg_locks даёт общую информацию по всем блокировкам в кластере баз данных, а
не только по тем, что относятся к текущей базе. Хотя соединив relation с pg_class.oid, можно
получить заблокированные отношения, это будет работать корректно только для отношений в те-
кущей базе данных (для тех, в блокировках которых столбец database содержит OID текущей базы
данных или ноль).
Соединив столбец pid со столбцом pid представления pg_stat_activity, можно получить допол-
нительную информацию о сеансах, удерживающих или ожидающих каждую блокировку, например
так:
SELECT * FROM pg_locks pl LEFT JOIN pg_stat_activity psa
ON pl.pid = psa.pid;
Также, если вы используете подготовленные транзакции, столбец virtualtransaction можно со-
единить со столбцом transaction представления pg_prepared_xacts для получения дополнитель-
ной информации о подготовленных транзакциях, удерживающих блокировки. (Подготовленная
транзакция не может ожидать блокировок, но она может продолжать удерживать блокировки, по-
лученные ей в процессе выполнения.) Например:
SELECT * FROM pg_locks pl LEFT JOIN pg_prepared_xacts ppx
2004Системные каталоги
ON pl.virtualtransaction = '-1/' || ppx.transaction;
Хотя в принципе возможно получить информацию о процессах, которые блокируют другие про-
цессы, соединив представление pg_locks с ним же, очень трудно сделать это правильно во всех
деталях. В частности потому, что такой запрос должен будет знать, какие режимы блокиров-
ки конфликтуют с другими. Мало того, представление pg_locks не показывает, какие процессы
стоят перед какими в очередях ожидания блокировок, а также какие процессы являются парал-
лельными рабочими процессами и к каким клиентским сеансам они относятся. Чтобы узнать, ка-
ким процессом или процессами блокируется ожидающий процесс, лучше использовать функцию
pg_blocking_pids() (см. Таблицу 9.60).
В представлении pg_locks показываются данные и из менеджера обычных блокировок, и из ме-
неджера предикатных блокировок, которые являются отдельными механизмами; кроме того, ме-
неджер обычных блокировок подразделяет свои блокировки на обычные и полученные быстрым
путём. Абсолютная согласованность всех этих данных не гарантируется. При обращении к этому
представлению данные блокировок по быстрому пути (с fastpath = true) собираются по очереди
с каждого серверного процесса, без замораживания состояния всего менеджера блокировок, так
что существует возможность, что в процессе сбора этой информации блокировки будут освобож-
дены или получены. Заметьте, однако, что эти блокировки не должны конфликтовать с любыми
другими актуальными блокировками. После того как от всех процессов получены блокировки по
быстрому пути, менеджер обычных блокировок замораживается целиком и информация обо всех
оставшихся блокировках собирается в атомарной операции. После размораживания этого мене-
джера, также замораживается менеджер предикатных блокировок, и информация об этих блоки-
ровках собирается атомарно. Таким образом, за исключением блокировок по быстрому пути, каж-
дый менеджер блокировок выдаёт согласованный набор результатов, но так как мы не блокиру-
ем оба этих менеджера одновременно, блокировки могут быть получены или освобождены после
того, как опрашивается менеджер обычных блокировок, и до того, как опрашивается менеджер
предикатных блокировок.
Блокировка менеджера обычных или предикатных блокировок может отразиться на производи-
тельности базы данных, если обращаться к этому представлению часто. Эта блокировка удержи-
вается не дольше, чем необходимо для получения данных от менеджеров, но это не исключает
возможность снижения производительности.
52.74. pg_matviews
Представление pg_matviews даёт доступ к полезной информации обо всех материализованных
представлениях в базе данных.
Таблица 52.75. Столбцы pg_matviews
Имя Тип Ссылки
Описание
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей материализован-
ное представление
matviewname name pg_class .relname
Имя материализован-
ного представления
matviewowner name pg_authid .rolname
Имя владельца матери-
ализованного представ-
ления
tablespace name pg_
tablespace .spcname
Имя табличного про-
странства, содержаще-
го материализованное
представление (NULL,
если это пространство
по умолчанию)
hasindexes boolean
True, если материали-
зованное представле-
2005Системные каталоги
Имя Тип
Ссылки
Описание
ние имеет (или недавно
имело) индексы
ispopulated boolean True, если материали-
зованное представле-
ние в данный момент
наполнено
definition text Определение материа-
лизованного представ-
ления (реконструиро-
ванный запрос SELECT)
52.75. pg_policies
Представление pg_policies даёт доступ к полезной информации обо всех политиках защиты на
уровне строк в базе данных.
Таблица 52.76. Столбцы pg_policies
Имя Тип Ссылки
Описание
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей таблицу с этой по-
литикой
tablename name pg_class .relname Имя таблицы с этой по-
литикой
policyname name pg_policy .polname Имя политики
polpermissive text Является ли полити-
ка разрешительной или
ограничительной?
roles name[] Роли, к которым приме-
няется политика
cmd text Тип команды, к которо-
му применяется поли-
тика
qual text Выражение, добавляе-
мое к условиям барье-
ра безопасности в за-
просы, к которым при-
меняется политика
with_check text Выражение, добавляе-
мое к условиям WITH
CHECK в запросы, ко-
торые пытаются добав-
лять строки в таблицу
52.76. pg_prepared_statements
В представлении pg_prepared_statements отображаются все подготовленные операторы, суще-
ствующие в текущем сеансе. За дополнительными сведениями о подготовленных операторах об-
ратитесь к PREPARE.
Представление pg_prepared_statements содержит отдельную строку для каждого подготовленно-
го оператора. Строки добавляются в него, когда создаётся новый подготовленный оператор, и уда-
ляются, когда подготовленный оператор освобождается (например, командой DEALLOCATE).
2006Системные каталоги
Таблица 52.77. Столбцы pg_prepared_statements
Имя Тип Описание
name text Идентификатор подготовленно-
го оператора
statement text Строка запроса, переданно-
го клиентом и создавшего
этот подготовленный оператор.
Для подготовленных операто-
ров, создаваемых через SQL,
это оператор PREPARE, передан-
ный клиентом. Для подготов-
ленных операторов, созданных
через клиент-серверный прото-
кол, этот текст представляет
сам подготовленный оператор.
prepare_time timestamptz Время, в которое был создан
подготовленный оператор
parameter_types regtype[] Ожидаемые типы параметров
для подготовленного оператора
в форме массива regtype. OID,
соответствующий элементу это-
го массива, может быть получен
в результате приведения значе-
ния regtype к oid.
from_sql boolean Значение true, если подготов-
ленный оператор был создан
SQL-командой PREPARE; false,
если оператор был подготовлен
через клиент-серверный прото-
кол
Представление pg_prepared_statements доступно только для чтения.
52.77. pg_prepared_xacts
Представление pg_prepared_xacts содержит информацию о транзакциях, которые в настоя-
щее время подготовлены для двухфазной фиксации (за подробностями обратитесь к PREPARE
TRANSACTION).
Представление pg_prepared_xacts содержит отдельную запись для каждой подготовленной тран-
закции. Эта запись удаляется, когда транзакция фиксируется или откатывается.
Таблица 52.78. Столбцы pg_prepared_xacts
Имя Тип
Ссылки
transaction xid Числовой
идентифи-
катор подготовленной
транзакции
gid text Глобальный идентифи-
катор транзакции, на-
значаемый транзакции
prepared timestamp
zone
with
time
2007
Описание
Время, в которое тран-
закция была подготов-
лена для фиксацииСистемные каталоги
Имя Тип Ссылки Описание
owner name pg_authid .rolname Имя пользователя, вы-
полнявшего
транзак-
цию
database name pg_database .datname Имя базы данных, в
которой выполнялась
транзакция
Когда запрашивается представление pg_prepared_xacts, внутренние структуры данных менедже-
ра транзакций на мгновение блокируются и создаётся их копия для вывода через это представле-
ние. Это гарантирует, что представление выдаёт согласованный набор результатов, при этом не
задерживая обычные операции на более продолжительное время, чем необходимо. Тем не менее,
это может отрицательно сказаться на производительности базы данных при частых обращениях
к представлению.
52.78. pg_publication_tables
Представление pg_publication_tables содержит информацию о сопоставлениях публикаций с
таблицами, которые в них содержатся. В отличие от нижележащего каталога pg_publication_rel,
в это представление добавляются публикации, определённые как FOR ALL TABLES, так что с такими
публикациями будет присутствовать строка для каждой соответствующей таблицы.
Таблица 52.79. Столбцы pg_publication_tables
Имя Тип Ссылки
Описание
pubname name pg_
publication .pubname
Имя публикации
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей таблицу
tablename name pg_class .relname
Имя таблицы
52.79. pg_replication_origin_status
Представление pg_replication_origin_status содержит информацию о позиции воспроизведе-
ния записей репликации, достигнутой для определённого источника. Подробно источники репли-
кации описаны в Главе 50.
Таблица 52.80. Столбцы pg_replication_origin_status
Имя Тип Ссылки Описание
local_id Oid pg_replication_
origin .roident внутренний идентифи-
катор узла
external_id text pg_replication_
origin .roname внешний
тор узла
remote_lsn pg_lsn LSN исходного узла, до
которого были репли-
цированы данные.
local_lsn pg_lsn LSN данного узла, с ко-
торым был реплициро-
ван remote_lsn . При-
меняется при асин-
хронной фиксации для
сброса на диск записей
2008
идентифика-Системные каталоги
Имя
Тип
Ссылки
Описание
фиксации до сохране-
ния данных.
52.80. pg_replication_slots
Представление pg_replication_slots содержит список всех слотов репликации, существующих в
данный момент в кластере баз данных, а также их текущее состояние.
За дополнительной информацией о слотах репликации обратитесь к Подразделу 26.2.6 и Главе 49.
Таблица 52.81. Столбцы pg_replication_slots
Имя Тип
Ссылки
slot_name name Уникальный в рамках
кластера идентифика-
тор для слота реплика-
ции
plugin name Базовое имя разделя-
емого объекта, содер-
жащего модуль выво-
да, который использу-
ется этим логическим
слотом, либо NULL для
физических слотов.
slot_type text Тип
слота
—
physical (физический)
или logical (логиче-
ский)
datoid oid pg_database .oid OID базы данных, с ко-
торой связан этот слот,
либо NULL. С базой
данных могут быть свя-
заны только логиче-
ские слоты.
database text pg_database .datname Имя базы данных, с ко-
торой связан этот слот,
либо NULL. С базой
данных могут быть свя-
заны только логиче-
ские слоты.
temporary boolean True, если это времен-
ный слот репликации.
Временные слоты не со-
храняются на диск и ав-
томатически удаляют-
ся при ошибке или за-
вершении сеанса.
active boolean True, если слот активно
используется в данный
момент
active_pid integer ID процесса сеанса, за-
нимающего этот слот,
если данный слот ак-
тивно используется в
2009
ОписаниеСистемные каталоги
Имя Тип
Ссылки
Описание
данный момент. NULL,
если он не использует-
ся.
xmin xid Старейшая
транзак-
ция, которая должна
сохраняться в базе дан-
ных для этого слота.
VACUUM не сможет уда-
лять кортежи, удалён-
ные более поздними
транзакциями.
catalog_xmin xid Старейшая
транзак-
ция, затрагивающая си-
стемные каталоги, ко-
торая должна сохра-
няться в базе данных
для этого слота. VACUUM
не сможет удалять кор-
тежи, удалённые более
поздними транзакция-
ми.
restart_lsn pg_lsn Адрес (LSN) старейшей
записи в WAL, кото-
рая по-прежнему мо-
жет быть нужна пользо-
вателям этого слота и,
таким образом, не бу-
дет автоматически уда-
ляться при контроль-
ных точках. Принимает
значение NULL, если LSN
данного слота ещё не
резервировался.
confirmed_flush_lsn pg_lsn Адрес (LSN), до кото-
рого потребитель логи-
ческого слота подтвер-
дил получение данных.
Данные старее этого
LSN уже недоступны.
Для физических слотов
— NULL.
52.81. pg_roles
Представление pg_roles открывает доступ к информации о ролях в базах данных. Это просто до-
ступное для всех отображение каталога pg_authid, в котором очищено поле пароля.
В этом представлении выводится OID из нижележащей таблицы, так как это необходимо для со-
единений с другими каталогами.
Таблица 52.82. Столбцы pg_roles
Имя Тип
rolname name
Ссылки
Описание
Имя роли
2010Системные каталоги
Имя Тип
Ссылки
rolsuper bool Роли имеет права су-
перпользователя
rolinherit bool Роль автоматически на-
следует права ролей, в
которые она включена
rolcreaterole bool Роль может создавать
другие роли
rolcreatedb bool Роль может создавать
базы данных
rolcanlogin bool Роль может подклю-
чаться к серверу. То
есть эта роль может
быть указана в качестве
начального идентифи-
катора авторизации се-
анса
rolreplication bool Роль является ролью
репликации. Такие ро-
ли могут устанавливать
соединения для репли-
кации и создавать/уда-
лять слоты репликации.
rolconnlimit int4 Для ролей, которые мо-
гут подключаться к сер-
веру, это значение за-
даёт максимально раз-
решённое для этой ро-
ли число одновремен-
ных подключений. При
значении -1 ограниче-
ния нет.
rolpassword text Не пароль (всегда выво-
дится как ********)
rolvaliduntil timestamptz Срок действия паро-
ля (используется толь-
ко при аутентификации
по паролю); NULL, если
срок действия не огра-
ничен
rolbypassrls bool Роль не подчиняется
никаким политикам за-
щиты на уровне строк;
за подробностями обра-
титесь к Разделу 5.7.
rolconfig text[] Заданные
для
роли
значения по умолча-
нию переменных вре-
мени конфигурации
oid oid
pg_authid .oid
52.82. pg_rules
2011
Описание
Идентификатор ролиСистемные каталоги
Представление pg_rules открывает доступ к полезной информации о правилах перезаписи запро-
сов.
Таблица 52.83. Столбцы pg_rules
Имя Тип Ссылки
Описание
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей таблицу
tablename name pg_class .relname Имя таблицы, с которой
связано это правило
rulename name pg_rewrite .rulename Имя правила
definition text
Определение
прави-
ла (реконструирован-
ная команда создания)
Из представления pg_rules исключены правила ON SELECT для представлений и материализован-
ных представлений; их можно увидеть в pg_views и pg_matviews.
52.83. pg_seclabels
Представление pg_seclabels содержит информацию о метках безопасности. Это более простая в
использовании версия каталога pg_seclabel.
Таблица 52.84. Столбцы pg_seclabels
Имя Тип Ссылки Описание
objoid oid любой столбец OID OID объекта, к которо-
му относится эта метка
безопасности
classoid oid pg_class .oid OID системного катало-
га, к которому относит-
ся этот объект
objsubid int4 Для метки безопас-
ности, связанной со
столбцом таблицы, это
номер столбца (objoid
и classoid указывают
на саму таблицу). Для
всех других типов объ-
ектов это поле содер-
жит ноль.
objtype text Тип объекта, к кото-
рому применяется эта
метка, в текстовом ви-
де.
objnamespace oid objname text Имя объекта, к кото-
рому применяется эта
метка, в текстовом ви-
де.
provider text pg_seclabel .provider Поставщик меток без-
опасности, связанный с
этой меткой.
pg_namespace .oid
2012
OID пространства имён
объекта, если примени-
мо; иначе NULL.Системные каталоги
Имя Тип Ссылки Описание
label text pg_seclabel .label Метка
безопасности,
применённая к этому
объекту.
52.84. pg_sequences
Представление pg_sequences даёт доступ к полезной информации обо всех последовательностях
в базе данных.
Таблица 52.85. Столбцы pg_sequences
Имя Тип Ссылки schemaname name схемы,
содер-
pg_namespace .nspname Имя
жащей последователь-
ность
sequencename name pg_class .relname Имя
сти
sequenceowner name pg_authid .rolname Имя владельца после-
довательности
data_type regtype pg_type .oid Тип данных последова-
тельности
start_value bigint Начальное
значение
последовательности
min_value bigint Минимальное значение
последовательности
max_value bigint Максимальное значе-
ние последовательно-
сти
increment_by bigint Шаг увеличения после-
довательности
cycle boolean Зацикливается ли по-
следовательность
cache_size bigint Размер кеша последо-
вательности
last_value bigint Последнее
значение
последовательности,
записанное на диск. Ес-
ли используется кеши-
рование, это значение
может быть больше по-
следнего значения, по-
лученного из после-
довательности. Если к
этой последовательно-
сти ещё не обращались,
содержит NULL. Также
содержит NULL, если
текущий пользователь
не имеет права USAGE
или SELECT.
52.85. pg_settings
2013
Описание
последовательно-Системные каталоги
Представление pg_settings открывает доступ к параметрам времени выполнения сервера. По су-
ти оно представляет собой альтернативный интерфейс для команд SHOW и SET. Оно также позво-
ляет получить некоторые свойства каждого параметра, которые нельзя получить непосредствен-
но, используя команду SHOW, например, минимальные и максимальные значения.
Таблица 52.86. Столбцы pg_settings
Имя Тип Описание
name text Имя параметра конфигурации
времени выполнения
setting text Текущее значение параметра
unit text Неявно подразумеваемая еди-
ница измерения параметра
category text Логическая группа параметра
short_desc text Краткое описание параметра
extra_desc text Дополнительное, более подроб-
ное, описание параметра
context text Контекст, в котором может за-
даваться значение параметра (
см. ниже)
vartype text Тип параметра (bool, enum,
integer, real или string)
source text Источник текущего значения
параметра
min_val text Минимальное допустимое зна-
чение параметра (NULL для
нечисловых значений)
max_val text Максимально допустимое зна-
чение параметра (NULL для
нечисловых значений)
enumvals text[] Допустимые значения пара-
метра-перечисления (NULL для
значений не перечислений)
boot_val text Значение параметра, устанав-
ливаемое при запуске сервера,
если параметр не устанавлива-
ется другим образом
reset_val text Значение, к которому будет
сбрасывать параметр команда
RESET в текущем сеансе
sourcefile text Файл конфигурации, в котором
было задано текущее значение
(NULL для значений, получен-
ных не из файлов конфигура-
ции, или при чтении этого по-
ля не суперпользователем и
не членом роли pg_read_all_
settings ); полезно при ис-
пользовании указаний include
в файлах конфигурации
sourceline integer Номер строки в файле конфи-
гурации, в которой было за-
2014Системные каталоги
Имя Тип Описание
дано текущее значение (NULL
для значений, полученных не
из файлов конфигурации, или
при чтении этого поля не супер-
пользователем и не членом ро-
ли pg_read_all_settings
).
pending_restart boolean true, если значение изменено
в файле конфигурации, но тре-
буется перезапуск; в противном
случае — false.
Поле context может содержать одно из следующих значений (они перечислены в порядке умень-
шения сложности изменения параметров):
internal
Эти параметры нельзя изменить непосредственно; они отражают значения, определяемые
внутри системы. Некоторые из них можно изменить, пересобрав сервер с другими параметра-
ми конфигурации, либо передав другие аргументы команде initdb.
postmaster
Эти параметры могут быть применены только при запуске сервера, так что любое изменение
требует перезапуска сервера. Значения этих параметров обычно задаются в postgresql.conf,
либо передаются в командной строке при запуске сервера. Разумеется, параметры более низ-
кого уровня context также можно задать в момент запуска сервера.
sighup
Внесённые в postgresql.conf изменения этих параметров можно применить, не перезапуская
сервер. Если передать управляющему процессу сигнал SIGHUP, он перечитает postgresql.conf
и применит изменения. Управляющий процесс также перешлёт сигнал SIGHUP всем своим
дочерним процессам, чтобы они тоже приняли новое значение.
superuser-backend
Внесённые в postgresql.conf изменения этих параметров можно применить без перезапуска
сервера; их также можно задать для определённого сеанса в пакете запроса соединения (на-
пример, через переменную окружения PGOPTIONS, учитываемую библиотекой libpq), но сделать
это может только суперпользователь. Однако эти параметры никогда не меняются в сеансе,
когда он уже начат. Если вы измените их в postgresql.conf, отправьте сигнал SIGHUP управ-
ляющему процессу, чтобы он перечитал postgresql.conf. Новые значения подействуют только
на сеансы, запускаемые после этого.
backend
Внесённые в postgresql.conf изменения этих параметров можно применить без перезапуска
сервера; их также можно задать для определённого сеанса в пакете запроса соединения (на-
пример, через переменную окружения PGOPTIONS, учитываемую библиотекой libpq); это может
сделать любой пользователь в своём сеансе. Однако эти параметры никогда не меняются в се-
ансе, когда он уже начат. Если вы измените их в postgresql.conf, отправьте сигнал SIGHUP
управляющему процессу, чтобы он перечитал postgresql.conf. Новые значения подействуют
только на сеансы, запускаемые после этого.
superuser
Эти параметры можно изменить в postgresql.conf, либо в рамках сеанса, командой SET; но
только суперпользователи могут менять их, используя SET. Изменения в postgresql.conf будут
отражены в существующих сеансах, только если в них командой SET не были заданы локальные
значения.
2015Системные каталоги
user
Эти параметры можно задать в postgresql.conf, либо в рамках сеанса, командой SET. В рам-
ках сеанса изменять их разрешено всем пользователям. Изменения в postgresql.conf будут
отражены в существующих сеансах, только если в них командой SET не были заданы локальные
значения.
Чтобы узнать больше о различных способах изменения этих параметров, обратитесь к Разделу 19.1.
Представление pg_settings не допускает добавление и удаление строк, но допускает изменение.
Команда UPDATE, применённая к строке pg_settings, равнозначна выполнению команды SET для
этого параметра. Изменение повлияет только на значение в текущем сеансе. Если UPDATE выпол-
няется в транзакции, которая затем прерывается, эффект UPDATE пропадает, когда транзакция от-
катывается. После фиксирования окружающей транзакции этот эффект сохраняется до заверше-
ния сеанса, если он не будет переопределён другой командой UPDATE или SET.
52.86. pg_shadow
Представление pg_shadow существует для обратной совместимости: оно эмулирует каталог, суще-
ствовавший в PostgreSQL до версии 8.1. В нём показываются свойства всех ролей с признаком
rolcanlogin в pg_authid.
Такое имя («тень») объясняется тем фактом, что эта таблица не должна быть доступна на чтение
всем, так как она содержит пароли. Представление pg_user является доступным всем отображе-
нием pg_shadow, в котором очищено поле пароля.
Таблица 52.87. Столбцы pg_shadow
Имя Тип Ссылки Описание
usename name pg_authid .rolname Имя пользователя
usesysid oid pg_authid .oid ID этого пользователя
usecreatedb bool Пользователь может со-
здавать базы данных
usesuper bool Пользователь является
суперпользователем
userepl bool Пользователь
может
инициировать потоко-
вую репликацию, вклю-
чать и отключать ре-
жим резервного копи-
рования.
usebypassrls bool Пользователь не подчи-
няется никаким поли-
тикам защиты на уров-
не строк; за подробно-
стями обратитесь к Раз-
делу 5.7.
passwd text Пароль (возможно за-
шифрованный); NULL,
если он не задан. По-
дробнее хранение за-
шифрованных паролей
описано в pg_authid .
valuntil abstime Срок действия паро-
ля (используется толь-
ко при аутентификации
по паролю)
2016Системные каталоги
Имя Тип
useconfig text[]
Ссылки
Описание
Сеансовые значения по
умолчанию для пере-
менных конфигурации
времени выполнения
52.87. pg_stats
Представление pg_stats открывает доступ к информации, хранящейся в каталоге pg_statistic.
Это представление даёт доступ только к тем строкам каталога pg_statistic, что соответствуют
таблицам, которые пользователь может читать, таким образом это представление можно безопас-
но разрешить читать всем.
Кроме того, представление pg_stats сконструировано так, чтобы представлять информацию в бо-
лее понятном формате, чем нижележащий каталог — ценой того, что его схему приходится рас-
ширять всякий раз, когда для pg_statistic определяются новые типы слотов.
Таблица 52.88. Столбцы pg_stats
Имя Тип Ссылки schemaname name pg_namespace .nspname Имя схемы, содержа-
щей таблицу
tablename name pg_class .relname attname name pg_attribute .attname Имя столбца, описывае-
мого этой строкой
inherited bool Если true, в данных
этой строки учитывают-
ся значения в дочерних
столбцах, а не только в
указанной таблице
null_frac real Доля записей, в кото-
рых этот столбец содер-
жит NULL
avg_width integer Средний размер эле-
ментов в столбце, в бай-
тах
n_distinct real Число, большее нуля,
представляет пример-
ное количество раз-
личных
значений
в
столбце.
Если
это
число меньше нуля,
его модуль представ-
ляет количество раз-
личных значений, де-
лённое
на
количе-
ство строк. (Отрица-
тельная форма приме-
няется, когда ANALYZE
полагает, что число
различных
значений,
скорее всего, будет рас-
ти по мере роста таб-
лицы; положительная,
когда в столбце, веро-
ятно, будет фиксиро-
2017
Описание
Имя таблицыСистемные каталоги
Имя Тип
Ссылки
most_common_vals anyarray Список самых частых
значений в столбце. (
NULL, если не находят-
ся значения, появляю-
щиеся чаще других.)
most_common_freqs real[] Список частот самых
частых значений, то
есть число их вхожде-
ний, делённое на об-
щее количество строк.
(NULL, вместе с most_
common_vals .)
histogram_bounds anyarray Список значений, раз-
деляющих
значения
столбца на пример-
но одинаковые попу-
ляции. Значения most_
common_vals ,
если
они присутствуют, не
рассматриваются при
вычислении этой гисто-
граммы. (Этот столбец
содержит NULL, если
для типа данных столб-
ца не определён опе-
ратор &lt;, либо если в
most_common_vals пе-
речисляется вся попу-
ляция.)
correlation real Статистическая корре-
ляция между физиче-
ским порядком строк
и логическим порядком
значений столбца. До-
пустимые значения ле-
жат в диапазоне -1 .. +1.
Когда значение около
-1 или +1, сканирова-
ние индекса по столбцу
будет считаться дешев-
ле, чем когда это зна-
чение около нуля, как
результат уменьшения
случайного доступа к
диску. (Этот столбец со-
держит NULL, если для
2018
Описание
ванное количество воз-
можных значений.) На-
пример, -1 указывает на
столбец с уникальным
содержимым, в котором
количество различных
значений совпадает с
количеством строк.Системные каталоги
Имя Тип
Ссылки
Описание
типа данных столбца не
определён оператор &lt;.)
most_common_elems anyarray Список элементов, от-
личных от NULL, наибо-
лее часто присутствую-
щих в значениях столб-
ца. (NULL для скаляр-
ных типов.)
most_common_elem_
freqs real[] Список частот самых
частых элементов, то
есть доля строк, содер-
жащих минимум один
экземпляр данного зна-
чения. За частотами по
элементам следуют два
или три дополнитель-
ных значения: мини-
мум и максимум пред-
шествующих частот по
элементам и дополни-
тельно частота элемен-
тов NULL. (Принима-
ет значение NULL вме-
сте с most_common_
elems .)
elem_count_
histogram real[] Гистограмма количеств
различных и отличных
от NULL элементов в
значениях этого столб-
ца, за которой следу-
ет среднее количество
элементов, отличных от
NULL. (Принимает зна-
чение NULL для ска-
лярных типов.)
Максимальным числом записей в полях-массивах можно управлять на уровне столбцов, исполь-
зуя команду ALTER TABLE SET STATISTICS, или глобально, задав параметр времени выполнения
default_statistics_target.
52.88. pg_tables
Представление pg_tables даёт доступ к полезной информации обо всех таблицах в базе данных.
Таблица 52.89. Столбцы pg_tables
Имя Тип Ссылки
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей таблицу
tablename name pg_class .relname
Имя таблицы
tableowner name pg_authid .rolname
Имя владельца таблицы
tablespace name pg_
tablespace .spcname
Имя табличного про-
странства, содержаще-
го таблицу (NULL, ес-
2019
ОписаниеСистемные каталоги
Имя Тип Ссылки
Описание
ли это пространство по
умолчанию)
hasindexes boolean pg_class .relhasindex True, если эта табли-
ца имеет (или недавно
имела) индексы
hasrules boolean pg_class .relhasrules True, если для таблицы
определены (или были
определены) правила
hastriggers boolean True, если для таблицы
pg_
class .relhastriggers определены (или были
определены) триггеры
rowsecurity boolean True, если для таблицы
pg_
class .relrowsecurity включена защита строк
52.89. pg_timezone_abbrevs
Представление pg_timezone_abbrevs содержит список аббревиатур часовых поясов, которые в на-
стоящее время распознаются процедурами ввода даты/времени. Содержимое этого представления
меняется при изменении параметра времени выполнения timezone_abbreviations.
Таблица 52.90. Столбцы pg_timezone_abbrevs
Имя Тип Описание
abbrev text Сокращение часового пояса
utc_offset interval Смещение от UTC (положитель-
ное — к востоку от Гринвича)
is_dst boolean True, если эта аббревиатура за-
даёт летнее время
Большинство аббревиатур часовых поясов представляют фиксированные смещения от UTC, но в
некоторые поясах смещение менялось в ходе истории (за подробностями обратитесь к Разделу B.3).
В таких случаях данное представление отображает текущее значение.
52.90. pg_timezone_names
В представлении pg_timezone_names содержится список имён часовых поясов, распознаваемых
командой SET TIMEZONE, вместе с соответствующими аббревиатурами, смещением UTC и статусом
летнего времени. (Говоря технически строго, в PostgreSQL используется не UTC, так как не учиты-
ваются секунды координации.) В отличие от аббревиатур, представленных в pg_timezone_abbrevs,
многие из этих имён подразумевают некоторый набор правил перехода на летнее время. Поэтому
сопутствующая информация меняется при пересечении границ перехода на летнее время. Отоб-
ражаемая информация вычисляется, исходя из текущего значения CURRENT_TIMESTAMP.
Таблица 52.91. Столбцы pg_timezone_names
Имя Тип Описание
name text Название часового пояса
abbrev text Сокращение часового пояса
utc_offset interval Смещение от UTC (положитель-
ное — к востоку от Гринвича)
is_dst boolean True, если текущие данные от-
ражают летнее время
2020Системные каталоги
52.91. pg_user
Представление pg_user открывает доступ к информации о пользователях базы данных. Это просто
доступное для всех отображение представления pg_shadow, в котором очищено поле пароля.
Таблица 52.92. Столбцы pg_user
Имя Тип Описание
usename name Имя пользователя
usesysid oid ID этого пользователя
usecreatedb bool Пользователь может создавать
базы данных
usesuper bool Пользователь является супер-
пользователем
userepl bool Пользователь может иниции-
ровать потоковую репликацию,
включать и отключать режим
резервного копирования.
usebypassrls bool Пользователь не подчиняется
никаким политикам защиты на
уровне строк; за подробностями
обратитесь к Разделу 5.7.
passwd text Не пароль (всегда выводится
как ********)
valuntil abstime Срок действия пароля (исполь-
зуется только при аутентифика-
ции по паролю)
useconfig text[] Сеансовые значения по умолча-
нию для переменных конфигу-
рации времени выполнения
52.92. pg_user_mappings
Представление pg_user_mappings открывает доступ к информации о сопоставлениях пользовате-
лей. По сути это просто доступное для чтения всеми отображение pg_user_mapping, в котором по-
ле параметров показывается, только если у пользователя есть права читать его.
Таблица 52.93. Столбцы pg_user_mappings
Имя Тип Ссылки
Описание
umid oid pg_user_mapping srvid oid pg_foreign_
server .oid OID стороннего серве-
ра, содержащего это со-
поставление
srvname name pg_foreign_
server .srvname Имя стороннего серве-
ра
umuser oid pg_authid .oid OID сопоставляемой ло-
кальной роли, либо 0,
если сопоставление за-
даётся для всех
usename name
сопоставления
.oid OID
пользователей
Имя локального поль-
зователя, для которого
задано сопоставление
2021Системные каталоги
Имя Тип
umoptions text[]
Ссылки
Описание
Специальные парамет-
ры сопоставления поль-
зователей, в виде строк
«ключ=значение»
Для защиты информации о паролях, хранящейся в свойствах сопоставления пользователей, стол-
бец umoptions при чтении будет содержать не NULL, если только выполняется одно из этих усло-
вий:
• текущий пользователь является объектом сопоставления и владельцем сервера или имеет
право USAGE для него
• текущий пользователь является владельцем сервера и прочитывается сопоставление для
PUBLIC
• текущий пользователь является суперпользователем
52.93. pg_views
Представление pg_views даёт доступ к полезной информации обо всех представлениях в базе дан-
ных.
Таблица 52.94. Столбцы pg_views
Имя Тип Ссылки
Описание
schemaname name pg_namespace .nspname Имя схемы, содержа-
щей представление
viewname name pg_class .relname
Имя представления
viewowner name pg_authid .rolname
Имя владельца
ставления
definition text
пред-
Определение представ-
ления (реконструиро-
ванный запрос SELECT)
2022</КлючСервера></СохранённыйКлюч></соль></число></li>
</ol>

      <footer class="entry-meta">
        <span>Updated on <span class="entry-date date published updated"><time datetime="2018-12-03 T15:14:43-04:00">December 03, 2018</time></span></span>
        <span class="author vcard"><span class="fn">Sergey Khatsiola</span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/postgres/2018-12-01-PostgreSQL-V11_Doc-052/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://localhost:4000/postgres/2018-12-01-PostgreSQL-V11_Doc-052/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://localhost:4000/postgres/2018-12-01-PostgreSQL-V11_Doc-052/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2018 Sergey Khatsiola. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>



          

</body>
</html>
